import{_ as z}from"./VCard.vue_vue_type_script_setup_true_lang-PTAvzsv6.js";import{f as K,u as R,aA as j,h as o,E as H,o as i,c as _,a,v as s,b as t,q as A,F as O,i as Y,H as D,O as J,A as Q,k as X,t as I,K as Z,s as ee,p as ae}from"./index-CPQeoj50.js";import{_ as te}from"./PageLoader-CVVMFRJU.js";import{s as le}from"./index-DrOr8a5z.js";import{a as se,s as oe}from"./index-B-fmEUJX.js";import{s as re}from"./index-DUakjIpn.js";import{_ as ne}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-IRMrSdrb.js";import{_ as ie}from"./VNavbar.vue_vue_type_script_setup_true_lang-aTOVxp6y.js";import{u as B,F as h}from"./index-p30fdSMQ.js";import"./index-57mWwkce.js";import"./index-CyFKcpBt.js";import"./helpers-BF5XYaOm.js";const ue={class:"h-full"},de={key:0,class:"flex-col-center gap-1"},ce={class:"grid gap-3 w-full"},me={class:"grid gap-1"},pe={class:"grid gap-1"},fe={class:"w-5 rounded-full overlow-hidden"},ve=["src"],_e={class:"grid gap-1"},ge={class:"grid gap-1"},we={class:"mt-2"},be={class:"mt-2 overflow-y-auto md:h-[calc(100dvh-8rem)]"},he={key:1,class:"flex-center"},xe={key:2,class:"w-full grid gap-2 grid-cols-[repeat(auto-fill,minmax(200px,1fr))]"},ye={class:"flex flex-col items-center gap-2"},ke=["src"],$e={class:"font-medium"},Ce={class:"text-center text-sm"},Ve={class:"font-medium"},Pe=K({__name:"WithdrawView",setup(Ae){const g=Q(),S=R(),m=j(),u=o(),p=o(),x=o(),d=o(),y=o(!1),F=o(!1),k=o(null),$=o([]),E=async()=>{await B("user/currencies?where=isAvailableForUserWithdrawal,true",{loading:F,error:k,config:{router:g,cache:!0}},c=>{$.value=c.data})},U=async()=>{p.value=await navigator.clipboard.readText()},w=o(!1),r=o(null),M=async()=>{var v,n;const c=await B(`/user/accounts/${S.user.id}?key=userId&field=walletBalance`,{loading:w,error:r,config:{router:g,cache:!0}});if(!c){r.value=new h({message:"Failed to get account balanace",name:"ApiError",status:400});return}if(!d.value){r.value=new h({message:"Please, enter a valid amount",name:"ApiError",status:400});return}if(d.value>c.data.walletBalance){r.value=new h({message:`The amount exceeds your available account balance of $${c.data.walletBalance.toLocaleString()}`,name:"ApiError",status:400});return}const e=d.value-(((v=u.value)==null?void 0:v.withdrawalCharge)??0),f=await B(`/user/currency-rate/${(n=u.value)==null?void 0:n.abbr}?amount=${e}`,{loading:w,error:r,config:{router:g,cache:!0}});if(!f){r.value=new h({message:"Failed to get currency rate",name:"ApiError",status:400});return}m.depositDetails.walletBalance=c.data.walletBalance,m.depositDetails.amount=d.value,m.depositDetails.result=f.result,m.depositDetails.currency=f.currency,m.depositDetails.walletAddress=p.value,m.depositDetails.network=x.value,g.push({name:"confirm-withdrawal"})};return H(async()=>{await E()}),(c,e)=>{var W;const f=ie,v=ne,n=se,G=re,b=oe,C=le,N=Z,V=ee,L=J,P=te,T=ae,q=z;return i(),_("div",ue,[a(f),a(L,{visible:y.value,"onUpdate:visible":e[3]||(e[3]=l=>y.value=l),modal:"",header:`${(W=u.value)==null?void 0:W.abbr} Withdrawal`,class:"w-80 md:w-96"},{default:s(()=>[u.value?(i(),_("div",de,[t("div",ce,[r.value?(i(),A(v,{key:0,error:r.value,class:"mt-2"},null,8,["error"])):D("",!0),t("div",me,[e[5]||(e[5]=t("label",{class:"text-mute font-semibold text-sm"},"Amount",-1)),a(b,{class:"w-full *:dark:bg-slate-800"},{default:s(()=>[a(n,null,{default:s(()=>e[4]||(e[4]=[X("$")])),_:1}),a(G,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value=l),placeholder:"00.00",minFractionDigits:0,maxFractionDigits:2,class:"w-full *:dark:bg-slate-800"},null,8,["modelValue"])]),_:1})]),t("div",pe,[e[6]||(e[6]=t("label",{class:"text-mute font-semibold text-sm"},"Currency",-1)),a(b,{class:"w-full *:dark:bg-slate-800"},{default:s(()=>[a(n,null,{default:s(()=>[t("div",fe,[t("img",{src:u.value.image,class:"w-full h-full object-cover"},null,8,ve)])]),_:1}),a(C,{value:u.value.name,readonly:"",class:"w-full *:dark:bg-slate-800"},null,8,["value"])]),_:1})]),t("div",_e,[e[7]||(e[7]=t("label",{class:"text-mute font-semibold text-sm"},"Your Wallet Address",-1)),a(b,{class:"w-full *:dark:bg-slate-800"},{default:s(()=>[a(n,null,{default:s(()=>[a(N,{prime:"",name:"wallet"})]),_:1}),a(C,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=l=>p.value=l),modelModifiers:{trim:!0},placeholder:"e.g. 0x742d35Cc6634C0532925a3b44Bc454e4438f443",class:"w-full *:dark:bg-slate-800"},null,8,["modelValue"]),a(n,null,{default:s(()=>[a(V,{onClick:U,severity:"secondary",icon:"pi pi-clipboard"})]),_:1})]),_:1})]),t("div",ge,[e[8]||(e[8]=t("label",{class:"text-mute font-semibold text-sm"},"Network",-1)),a(b,{class:"w-full *:dark:bg-slate-800"},{default:s(()=>[a(n,null,{default:s(()=>[a(N,{prime:"",name:"share-alt"})]),_:1}),a(C,{modelValue:x.value,"onUpdate:modelValue":e[2]||(e[2]=l=>x.value=l),modelModifiers:{trim:!0},placeholder:"e.g. Kraken",class:"w-full *:dark:bg-slate-800"},null,8,["modelValue"])]),_:1})]),t("div",we,[a(V,{loading:w.value,disabled:w.value||!d.value||!p.value,onClick:M,label:"Confirm",fluid:""},null,8,["loading","disabled"])])])])):D("",!0)]),_:1},8,["visible","header"]),t("div",be,[F.value?(i(),A(P,{key:0})):k.value?(i(),_("div",he,[a(v,{error:k.value,request:"GET",onRetry:E},null,8,["error"])])):$.value?(i(),_("div",xe,[(i(!0),_(O,null,Y($.value,l=>(i(),A(q,{key:l.name,header:l.name},{default:s(()=>[t("div",ye,[t("img",{src:l.image,width:"40",class:"rounded-full"},null,8,ke),t("p",$e,I(l.abbr),1)]),a(T),t("div",Ce,[e[9]||(e[9]=t("p",{class:"text-center"},"Fixed Charge",-1)),t("p",Ve,"$"+I(l.withdrawalCharge),1)]),e[10]||(e[10]=t("div",{class:"text-center text-sm"},[t("p",{class:"text-center"},"Average Processing Time"),t("p",{class:"font-medium"},"1 day")],-1)),a(T),a(V,{onClick:De=>{u.value=l,y.value=!0},size:"small",label:`Withdraw via ${l.abbr}`,fluid:""},null,8,["onClick","label"])]),_:2},1032,["header"]))),128))])):D("",!0)])])}}});export{Pe as default};
