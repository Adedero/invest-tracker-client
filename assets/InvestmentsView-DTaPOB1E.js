import{_ as Y}from"./VPaginator.vue_vue_type_script_setup_true_lang-Ca-Vza0W.js";import{s as z,a as j}from"./index-2Uz0LzdM.js";import{s as K}from"./index-BWNXx86c.js";import{_ as F}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-BkdBNGI_.js";import{_ as G}from"./PageLoader-62ICEvpm.js";import{_ as H}from"./VCard.vue_vue_type_script_setup_true_lang-G04ysE6h.js";import{f as W,h as n,D as k,bp as J,o as u,c as T,a as t,v as r,b as l,q as A,j as _,H as Q,L as X,A as Z,k as g,t as y,a4 as ee,s as te}from"./index-rkqDWn-K.js";import{s as se}from"./index-2e_aBQmh.js";import{u as ae}from"./index-BJLvgVPt.js";import{t as oe}from"./investment-tier-C6RGqzcN.js";import{t as ne}from"./helpers-BF5XYaOm.js";import"./index-p1M208JQ.js";import"./index-DMxJWgcx.js";import"./index-BZ2gPtDN.js";import"./index-Bv-llqAV.js";import"./index-DOXnOG33.js";const le={class:"flex flex-col md:flex-row gap-2 justify-between"},re={class:"flex items-end gap-1 flex-wrap"},ie={class:"flex gap-1 flex-col"},de={class:"flex gap-1 flex-col"},me={class:"mt-2 md:h-[calc(100dvh-10rem)]"},ue={key:2,class:"h-full w-full overflow-auto"},c=10,Te=W({__name:"InvestmentsView",setup(ce){var V;const I=X(),x=Z(),h=(V=I.query.userId)==null?void 0:V.toString(),i=n("Open"),L=n(["All","Open","Paused","Closed","Terminated"]),d=n("All"),N=n(["All",...oe]),w=n(0),b=k(()=>w.value*c),C=k(()=>{const e=new URLSearchParams;return e.append("skip",b.value.toString()),e.append("limit",c.toString()),e.append("sort","createdAt,DESC"),e.append("relation","user"),h&&e.append("where",`userId,${h}`),i.value!=="All"&&e.append("where",`status,${i.value.toLowerCase()}`),d.value!=="All"&&e.append("where",`investmentTier,${d.value}`),e.toString()}),p=n(),m=n(!1),f=n(),S=n(!1),v=async()=>{await ae(`admin/investments?${C.value}`,{loading:m,error:f,config:{router:x,cache:!0}},e=>{S.value=e.data.length<c,p.value=e.data})};J(C,v,{debounce:600,maxWait:1e3,immediate:!0});async function D(e){w.value=e}function M(e){return e==="open"?"success":e==="closed"?"info":e==="paused"?"warn":"danger"}return(e,a)=>{const $=se,P=te,B=H,O=G,R=F,o=j,q=K,E=z,U=Y;return u(),T("div",null,[t(B,{class:"py-2"},{default:r(()=>[l("div",le,[a[5]||(a[5]=l("h1",{class:"text-lg font-semibold text-primary-500"},"Investments",-1)),l("div",re,[l("div",ie,[a[3]||(a[3]=l("label",{class:"text-xs text-mute font-semibold"},"Status",-1)),t($,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=s=>i.value=s),options:L.value,size:"small",class:"py-0"},null,8,["modelValue","options"])]),l("div",de,[a[4]||(a[4]=l("label",{class:"text-xs text-mute font-semibold"},"Tier",-1)),t($,{modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=s=>d.value=s),options:N.value,size:"small",class:"py-0"},null,8,["modelValue","options"])]),t(P,{onClick:v,loading:m.value,size:"small",label:"Submit"},null,8,["loading"])])])]),_:1}),l("div",me,[m.value?(u(),A(O,{key:0})):!m.value&&f.value?(u(),A(R,{key:1,error:f.value,request:"GET",onRetry:v,closable:""},null,8,["error"])):p.value?(u(),T("div",ue,[t(E,{value:p.value,class:"text-sm min-w-[60rem]",selectionMode:"single",dataKey:"id",metaKeySelection:!1,onRowClick:a[2]||(a[2]=s=>_(x).push({name:"admin-investment",params:{investmentId:s.data.id}}))},{default:r(()=>[t(o,{header:"S/N",style:{"min-width":"4rem"}},{body:r(({index:s})=>[g(y(s+1+b.value)+") ",1)]),_:1}),t(o,{field:"investmentName",header:"Investment"}),t(o,{field:"investmentTier",header:"Tier"}),t(o,{header:"Status"},{body:r(({data:s})=>[t(q,{class:"text-xs font-semibold",severity:M(s.status),value:_(ne)(s.status)},null,8,["severity","value"])]),_:1}),t(o,{field:"user.name",header:"User"}),t(o,{field:"amount",header:"Amount"},{body:r(({data:s})=>[g(" $"+y(s.initialDeposit.toLocaleString()),1)]),_:1}),t(o,{field:"duration",header:"Duration (days)"}),t(o,{field:"daysCompleted",header:"Days Completed (days)"}),t(o,{header:"Created On"},{body:r(({data:s})=>[g(y(_(ee)(new Date(s.createdAt),"ddd, DD MMM, YYYY hh:mm aa")),1)]),_:1})]),_:1},8,["value"]),t(U,{allLoaded:S.value,rows:c,onPrev:D,onNext:D},null,8,["allLoaded"])])):Q("",!0)])])}}});export{Te as default};
