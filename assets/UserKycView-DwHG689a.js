import{f as K,af as T,ag as $,h as d,E as z,o as a,c as r,a as o,v as m,b as t,q as p,H as l,A as E,t as c,j as f,a4 as w,s as j,K as P}from"./index-CW21LfwU.js";import{_ as U}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-BjwNYmRP.js";import{_ as B}from"./PageLoader-CZ-Kt3Ck.js";import{_ as H}from"./VCard.vue_vue_type_script_setup_true_lang-BEXAQp5x.js";import{u as S}from"./index-Bco5Uctx.js";import{t as q}from"./helpers-BF5XYaOm.js";const N={class:"mt-2"},R={key:2,class:"md:h-[calc(100dvh-8.5rem)] grid md:grid-cols-3 gap-2"},F={class:"md:col-span-2 md:h-full md:overflow-y-auto"},G={class:"flex items-center gap-5 justify-between"},L={class:"mt-4 grid gap-2"},J={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},O={class:"flex items-center"},Q={class:"text-right font-semibold"},W={key:0,class:"contents"},X={key:0,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Z={class:"flex items-center"},ee={class:"text-right font-semibold"},te={key:1,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},se={class:"flex items-center"},ae={class:"flex justify-end"},oe=["href","download"],ie={key:2,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},le={class:"flex items-center"},re={class:"text-right font-semibold"},ne={key:3,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},ce={class:"flex items-center"},de={class:"text-right font-semibold"},ue={class:"md:h-full md:overflow-y-auto"},me={class:"flex flex-col items-center justify-center gap-2 text-center"},pe={class:"w-32 aspect-square rounded-full overflow-hidden bg-slate-200 dark:bg-slate-800"},fe=["src"],ve={class:"font-semibold md:text-lg"},_e={class:"text-sm text-mute"},Se=K({__name:"UserKycView",setup(ye){var D;const u=E(),C=T(),b=$(),Y=(D=u.currentRoute.value.params.accountId)==null?void 0:D.toString(),e=d(),g=d(!1),v=d();async function x(){await S(`admin/accounts/${Y}?relation=user`,{loading:g,error:v,config:{router:u,cache:!0}},i=>{e.value=i.data})}const h=d(!1),_=d();async function V(){if(!e.value||e.value.kycStatus==="unverified")return;const i=e.value.kycStatus==="pending",s={kycIdType:i?e.value.kycIdType:null,kycDocument:i?e.value.kycDocument:null,kycDocumentExt:i?e.value.kycDocumentExt:null,kycStatus:i?"verified":"unverified",kycSubmittedAt:i?e.value.kycSubmittedAt:null,kycVerifiedAt:i?new Date:null};if(await S(`admin/accounts/${e.value.id}`,{loading:h,error:_,config:{router:u,method:"PUT",body:{data:s}}},()=>{b.add({severity:"success",summary:"Done",detail:"KYC Status updated",life:3e3}),e.value&&e.value.user&&(e.value={...e.value,...s})}),_.value){b.add({severity:"error",summary:"Failed",detail:_.value.message,life:6e3});return}}const A=()=>{C.require({header:"Update KYC Status",message:"Are you sure you want to proceed?",rejectProps:{label:"Cancel",severity:"secondary",icon:"pi pi-times"},acceptProps:{label:"Proceed",icon:"pi pi-check"},accept:()=>{V()}})};return z(async()=>{await x()}),(i,s)=>{const y=H,M=B,I=U,k=j,n=P;return a(),r("div",null,[o(y,{class:"py-2 px-4"},{default:m(()=>s[1]||(s[1]=[t("div",{class:"text-lg text-primary-500 font-semibold"},"KYC Verification Status",-1)])),_:1}),t("div",N,[g.value?(a(),p(M,{key:0})):v.value?(a(),p(I,{key:1,error:v.value,request:"GET",onRetry:x},null,8,["error"])):e.value?(a(),r("div",R,[t("div",F,[o(y,{header:"KYC Details"},{header:m(()=>[t("div",G,[s[2]||(s[2]=t("p",{class:"font-semibold text-mute"},"KYC Details",-1)),e.value.kycStatus!=="unverified"?(a(),p(k,{key:0,label:e.value.kycStatus==="pending"?"Verify":"Discard",onClick:A,loading:h.value,icon:e.value.kycStatus==="pending"?"pi pi-check-circle":"pi pi-times-circle"},null,8,["label","loading","icon"])):l("",!0)])]),default:m(()=>[t("div",L,[t("div",J,[t("div",O,[o(n,{prime:"",name:"check-circle",size:"12",class:"text-mute p-1 rounded-full"}),s[3]||(s[3]=t("p",{class:"text-mute text-sm font-semibold"},"KYC Status",-1))]),t("p",Q,c(f(q)(e.value.kycStatus)),1)]),e.value.kycStatus!=="unverified"?(a(),r("div",W,[e.value.kycIdType?(a(),r("div",X,[t("div",Z,[o(n,{prime:"",name:"id-card",size:"12",class:"text-mute p-1 rounded-full"}),s[4]||(s[4]=t("p",{class:"text-mute text-sm font-semibold"},"ID Type",-1))]),t("p",ee,c(e.value.kycIdType),1)])):l("",!0),e.value.kycDocument?(a(),r("div",te,[t("div",se,[o(n,{prime:"",name:"file",size:"12",class:"text-mute p-1 rounded-full"}),s[5]||(s[5]=t("p",{class:"text-mute text-sm font-semibold"},"Submitted Document",-1))]),t("div",ae,[t("a",{href:e.value.kycDocument,download:`${e.value.id}.${e.value.kycDocumentExt}`},[o(k,{label:"Download",icon:"pi pi-download",size:"small",outlined:""})],8,oe)])])):l("",!0),e.value.kycSubmittedAt?(a(),r("div",ie,[t("div",le,[o(n,{prime:"",name:"calendar-clock",size:"12",class:"text-mute p-1 rounded-full"}),s[6]||(s[6]=t("p",{class:"text-mute text-sm font-semibold"},"Submission Date",-1))]),t("p",re,c(f(w)(new Date(e.value.kycSubmittedAt),"ddd, MMMM DD, YYYY HH:mm aa")),1)])):l("",!0),e.value.kycVerifiedAt?(a(),r("div",ne,[t("div",ce,[o(n,{prime:"",name:"calendar-clock",size:"12",class:"text-mute p-1 rounded-full"}),s[7]||(s[7]=t("p",{class:"text-mute text-sm font-semibold"},"Verified Date",-1))]),t("p",de,c(f(w)(new Date(e.value.kycVerifiedAt),"ddd, MMMM DD, YYYY HH:mm aa")),1)])):l("",!0)])):l("",!0)])]),_:1})]),t("div",ue,[e.value.user?(a(),p(y,{key:0,header:"User"},{default:m(()=>[t("div",me,[t("div",pe,[e.value.user.image?(a(),r("img",{key:0,src:e.value.user.image,class:"w-full h-full object-cover"},null,8,fe)):l("",!0),o(n,{name:"account_circle",size:"8rem",class:"text-primary-500"})]),t("div",null,[t("p",ve,c(e.value.user.name),1),t("p",_e,c(e.value.user.email),1)]),o(k,{onClick:s[0]||(s[0]=ke=>f(u).push({name:"admin-user",params:{userId:e.value.user.id}})),label:"Profile",icon:"pi pi-user",outlined:""})])]),_:1})):l("",!0)])])):l("",!0)])])}}});export{Se as default};
