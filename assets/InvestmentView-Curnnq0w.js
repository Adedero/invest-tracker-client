import{f as Y,A as L,ag as F,af as P,h as p,o as l,c as m,b as e,I as B,a as o,v as r,k as E,t as a,s as V,O as j,D as U,E as q,q as I,H as _,j as x,a4 as $,B as H,K as G}from"./index-CPQeoj50.js";import{s as K}from"./index-BkcPCWXP.js";import{s as O}from"./index-CQWMnh3F.js";import{u as N}from"./index-p30fdSMQ.js";import{s as J}from"./index-BrhkCp4d.js";import{_ as Q}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-IRMrSdrb.js";import{_ as W}from"./PageLoader-CVVMFRJU.js";import{_ as X}from"./VCard.vue_vue_type_script_setup_true_lang-PTAvzsv6.js";import{t as S}from"./helpers-BF5XYaOm.js";import"./index-57mWwkce.js";import"./index-CyFKcpBt.js";const Z={class:"grid gap-1"},ee={class:"mt-4 flex items-center gap-2 flex-wrap"},te={for:"apply-fee",class:"text-sm text-mute font-medium"},se={class:"mt-4 flex items-center gap-3 justify-end"},oe="admin",ae=Y({__name:"InvestmentTerminator",props:{investment:{}},emits:["terminate"],setup(M,{emit:k}){const z=k,t=L(),w=F(),D=P(),v=p(!1),f=p(""),b=p(!1),T=p(!1),h=p();async function u(){const g={status:"terminated",terminationReason:f.value,terminator:oe,terminationFeeApplied:b.value,terminatedAt:new Date().toString()};if(await N(`admin/investments/${M.investment.id}`,{loading:T,error:h,config:{router:t,method:"PATCH",body:g}},d=>{z("terminate",d.data),w.add({severity:"success",summary:"Done",detail:"Investment terminated.",life:3e3}),i()}),h.value){w.add({severity:"error",summary:"Failed",detail:h.value.message,life:6e3});return}}const s=()=>{D.require({header:"Confirm Investment Termination",message:"Are you sure you want to proceed? This action cannot be reversed.",rejectProps:{severity:"secondary",label:"Cancel"},acceptProps:{severity:"danger",label:"Terminate"},reject:()=>{i()},accept:()=>{u()}})};function i(){f.value="",b.value=!1,v.value=!1}return(g,d)=>{const y=V,R=O,n=K,A=j;return l(),m("div",null,[e("div",{onClick:d[0]||(d[0]=c=>v.value=!0),class:"cursor-pointer"},[B(g.$slots,"default",{},()=>[o(y,{label:"Terminate Investment",icon:"pi pi-chevron-right","icon-pos":"right",size:"small",fluid:"",severity:"danger"})])]),e("div",null,[o(A,{visible:v.value,"onUpdate:visible":d[3]||(d[3]=c=>v.value=c),modal:"",header:"Terminate Investment",class:"w-80",onHide:i},{default:r(()=>[e("div",null,[e("div",Z,[d[4]||(d[4]=e("label",{for:"reason",class:"text-sm text-mute font-medium"},[E(" Reason for termination "),e("span",{class:"text-red-500"},"*")],-1)),o(R,{modelValue:f.value,"onUpdate:modelValue":d[1]||(d[1]=c=>f.value=c),modelModifiers:{trim:!0},fluid:"",col:"5",class:"resize-none",id:"reason"},null,8,["modelValue"])]),e("div",ee,[o(n,{binary:"",modelValue:b.value,"onUpdate:modelValue":d[2]||(d[2]=c=>b.value=c),id:"apply-fee"},null,8,["modelValue"]),e("label",te," Apply $"+a(g.investment.terminationFee.toLocaleString())+" termination fee ",1)]),e("div",se,[o(y,{onClick:i,label:"Cancel",severity:"secondary"}),o(y,{loading:T.value,disabled:T.value||!f.value,onClick:s,label:"Terminate",severity:"danger"},null,8,["loading","disabled"])])])]),_:1},8,["visible"])])])}}}),ne={class:"text-lg font-semibold text-primary-500"},ie={class:"text-sm"},le={class:"mt-2"},re={key:2},de={class:"md:h-[calc(100dvh-8.5rem)] grid md:grid-cols-3 gap-2"},me={class:"md:h-full md:overflow-y-auto md:col-span-2"},ue={class:"grid gap-2 md:grid-cols-3"},ce={class:"text-xl font-semibold"},pe={class:"text-sm"},ve={class:"text-xl font-semibold"},fe={class:"text-sm"},_e={class:"text-xs font-medium text-mute"},xe={class:"text-xl font-semibold"},be={class:"text-sm"},he={class:"text-xs font-medium text-mute"},ge={key:0},ye={key:1},ke={class:"text-xl font-semibold"},we={key:0},De={key:1},Te={class:"grid gap-2"},Re={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},$e={class:"flex items-center"},ze={class:"text-right font-semibold"},Ae={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Ce={class:"flex items-center"},Ie={class:"text-right font-semibold"},Me={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Se={class:"flex items-center"},Ye={class:"text-right font-semibold"},Le={key:0,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Ve={class:"flex items-center"},Ne={class:"text-right font-semibold"},Fe={key:1,class:"contents"},Pe={key:0,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Be={class:"flex items-center"},Ee={class:"text-right font-semibold"},je={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Ue={class:"flex items-center"},qe={class:"text-right font-semibold"},He={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Ge={class:"flex items-center"},Ke={class:"text-right font-semibold"},Oe={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Je={class:"flex items-center"},Qe={class:"text-right font-semibold"},We={class:"md:h-full md:overflow-y-auto"},Xe={class:"flex flex-col items-center justify-center gap-2 text-center"},Ze={class:"w-32 aspect-square rounded-full overflow-hidden bg-slate-200 dark:bg-slate-800"},et=["src"],tt={class:"font-semibold md:text-lg"},st={class:"text-sm text-mute"},ot={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},at={class:"flex items-center"},nt={class:"text-right font-semibold"},it={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},lt={class:"flex items-center"},rt={class:"text-right font-semibold"},dt={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},mt={class:"flex items-center"},ut={class:"text-right font-semibold"},ct={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},pt={class:"flex items-center"},vt={class:"text-right font-semibold"},ft={key:0,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},_t={class:"flex items-center"},xt={class:"text-right font-semibold"},bt={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},ht={class:"flex items-center"},gt={class:"text-right font-semibold"},yt={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},kt={class:"flex items-center"},wt={class:"text-right font-semibold"},Dt={key:0,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Tt={class:"flex items-center"},Rt={class:"my-1"},$t={key:1,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},zt={class:"flex items-center"},Bt=Y({__name:"InvestmentView",setup(M){var h;const k=L(),z=(h=k.currentRoute.value.params.investmentId)==null?void 0:h.toString(),t=p(),w=p(!1),D=p();async function v(){await N(`admin/investments/${z}?relation=user`,{loading:w,error:D,config:{router:k,cache:!0}},u=>{t.value=u.data})}const f=U(()=>t.value?parseFloat((t.value.currentTotalReturns/t.value.initialDeposit*100).toFixed(2)):0),b=u=>{t.value={...t.value,...u}};function T(u){return u==="open"?"success":u==="closed"?"info":"danger"}return q(async()=>{await v()}),(u,s)=>{const i=X,g=W,d=Q,y=J,R=H,n=G,A=V,c=ae;return l(),m("div",null,[o(i,{class:"p-2"},{default:r(()=>{var C;return[e("div",ne,[s[1]||(s[1]=e("span",null,"Investment ",-1)),e("span",ie,"ID: "+a((C=t.value)==null?void 0:C.id),1)])]}),_:1}),e("div",le,[w.value?(l(),I(g,{key:0})):D.value?(l(),I(d,{key:1,error:D.value,request:"GET",onRetry:v},null,8,["error"])):t.value?(l(),m("div",re,[e("div",de,[e("div",me,[e("div",ue,[o(i,{header:"Deposit"},{default:r(()=>[e("div",ce,[e("span",null," $"+a(t.value.initialDeposit.toLocaleString().split(".")[0])+".",1),e("span",pe,a(t.value.initialDeposit.toLocaleString().split(".")[1]??"00"),1)]),s[2]||(s[2]=e("p",{class:"text-xs font-medium text-mute"},"Initial deposit amount",-1))]),_:1}),o(i,{header:"Current Total Returns"},{default:r(()=>[e("div",ve,[e("span",null," $"+a(t.value.currentTotalReturns.toLocaleString().split(".")[0])+". ",1),e("span",fe,a(t.value.currentTotalReturns.toLocaleString().split(".")[1]??"00"),1)]),e("p",_e,a(f.value)+"% of initial deposit ",1)]),_:1}),o(i,{header:"Last Return"},{default:r(()=>[e("div",xe,[e("span",null," $"+a(t.value.lastProfitAmount.toLocaleString().split(".")[0])+".",1),e("span",be,a(t.value.lastProfitAmount.toLocaleString().split(".")[1]??"00"),1)]),e("p",he,[t.value.lastProfitDistributedAt?(l(),m("span",ge,a(x($)(new Date(t.value.lastProfitDistributedAt),"ddd, DD MMM, YYYY hh:mm aa")),1)):(l(),m("span",ye,"No profit distributed yet"))])]),_:1}),o(i,{header:"Status"},{default:r(()=>[o(y,{class:"font-semibold",severity:T(t.value.status),value:x(S)(t.value.status)},null,8,["severity","value"])]),_:1}),o(i,{header:"Days Completed"},{default:r(()=>[e("div",ke,[e("span",null,a(t.value.daysCompleted),1),s[3]||(s[3]=e("span",{class:"text-sm"}," Days ",-1))])]),_:1}),o(i,{header:"Auto-compounding"},{default:r(()=>[o(y,{class:"font-semibold",severity:t.value.autocompounded?"success":"warn",value:t.value.autocompounded?"Enabled":"Disabled"},null,8,["severity","value"])]),_:1})]),o(i,{header:"Daily Returns",class:"mt-2"},{default:r(()=>[o(R,{size:"small",class:"text-sm",icon:"pi pi-info-circle"},{default:r(()=>[t.value.autocompounded?(l(),m("p",we," The daily returns from this investment "+a(t.value.status==="open"?"are":"were")+" withheld and "+a(t.value.status==="open"?"will be":"were")+" added to the client's wallet balance when the investment is closed or terminated. ",1)):(l(),m("p",De," The returns from this investment "+a(t.value.status==="open"?"are":"were")+" added to the client's wallet balance on a daily basis until the investment was closed or terminated. ",1))]),_:1})]),_:1}),o(i,{header:"Details",class:"mt-2"},{default:r(()=>[e("div",Te,[e("div",Re,[e("div",$e,[o(n,{prime:"",name:"dollar",size:"12",class:"text-mute p-1 rounded-full"}),s[4]||(s[4]=e("p",{class:"text-mute text-sm font-semibold"},"Expected Total Returns",-1))]),e("p",ze," $"+a(t.value.expectedTotalReturns.toLocaleString()),1)]),e("div",Ae,[e("div",Ce,[o(n,{prime:"",name:"dollar",size:"12",class:"text-mute p-1 rounded-full"}),s[5]||(s[5]=e("p",{class:"text-mute text-sm font-semibold"},"Current Total Returns",-1))]),e("p",Ie," $"+a(t.value.currentTotalReturns.toLocaleString()),1)]),e("div",Me,[e("div",Se,[o(n,{prime:"",name:"calendar",size:"12",class:"text-mute p-1 rounded-full"}),s[6]||(s[6]=e("p",{class:"text-mute text-sm font-semibold"},"Created Date",-1))]),e("p",Ye,a(x($)(new Date(t.value.createdAt),"ddd, DD MMM, YYYY hh:mm aa")),1)]),t.value.status==="closed"&&t.value.closedAt?(l(),m("div",Le,[e("div",Ve,[o(n,{prime:"",name:"dollar",size:"12",class:"text-mute p-1 rounded-full"}),s[7]||(s[7]=e("p",{class:"text-mute text-sm font-semibold"},"Closed Date",-1))]),e("p",Ne,a(x($)(new Date(t.value.closedAt),"ddd, DD MMM, YYYY hh:mm aa")),1)])):_("",!0),t.value.status==="terminated"?(l(),m("div",Fe,[t.value.terminatedAt?(l(),m("div",Pe,[e("div",Be,[o(n,{prime:"",name:"calendar",size:"12",class:"text-mute p-1 rounded-full"}),s[8]||(s[8]=e("p",{class:"text-mute text-sm font-semibold"},"Terminated Date",-1))]),e("p",Ee,a(x($)(new Date(t.value.terminatedAt),"ddd, DD MMM, YYYY hh:mm aa")),1)])):_("",!0),e("div",je,[e("div",Ue,[o(n,{prime:"",name:"info-circle",size:"12",class:"text-mute p-1 rounded-full"}),s[9]||(s[9]=e("p",{class:"text-mute text-sm font-semibold"},"Terminated Fee",-1))]),e("p",qe,a(t.value.terminationFeeApplied?"Applied":"Not applied"),1)]),e("div",He,[e("div",Ge,[o(n,{prime:"",name:"info-circle",size:"12",class:"text-mute p-1 rounded-full"}),s[10]||(s[10]=e("p",{class:"text-mute text-sm font-semibold"},"Terminated By",-1))]),e("p",Ke,a(x(S)(t.value.terminator)||"No terminator indicated"),1)]),e("div",Oe,[e("div",Je,[o(n,{prime:"",name:"info-circle",size:"12",class:"text-mute p-1 rounded-full"}),s[11]||(s[11]=e("p",{class:"text-mute text-sm font-semibold"},"Termination Reason",-1))]),e("p",Qe,a(t.value.terminationReason||"No reason provided"),1)])])):_("",!0)])]),_:1})]),e("div",We,[t.value.user?(l(),I(i,{key:0,header:"User"},{default:r(()=>[e("div",Xe,[e("div",Ze,[t.value.user.image?(l(),m("img",{key:0,src:t.value.user.image,class:"w-full h-full object-cover"},null,8,et)):_("",!0),o(n,{name:"account_circle",size:"8rem",class:"text-primary-500"})]),e("div",null,[e("p",tt,a(t.value.user.name),1),e("p",st,a(t.value.user.email),1)]),o(A,{onClick:s[0]||(s[0]=C=>x(k).push({name:"admin-user",params:{userId:t.value.user.id}})),label:"Profile",icon:"pi pi-user",outlined:""})])]),_:1})):_("",!0),o(i,{header:"Investment Plan Details",class:"mt-2 grid gap-2"},{default:r(()=>[e("div",ot,[e("div",at,[o(n,{prime:"",name:"info-circle",size:"12",class:"text-mute p-1 rounded-full"}),s[12]||(s[12]=e("p",{class:"text-mute text-sm font-semibold"},"Investment Name",-1))]),e("p",nt,a(t.value.investmentName),1)]),e("div",it,[e("div",lt,[o(n,{prime:"",name:"sitemap",size:"12",class:"text-mute p-1 rounded-full"}),s[13]||(s[13]=e("p",{class:"text-mute text-sm font-semibold"},"Investment Tier",-1))]),e("p",rt,a(t.value.investmentTier),1)]),e("div",dt,[e("div",mt,[o(n,{prime:"",name:"money-bill",size:"12",class:"text-mute p-1 rounded-full"}),s[14]||(s[14]=e("p",{class:"text-mute text-sm font-semibold"},"Minimum Deposit",-1))]),e("p",ut," $"+a(t.value.minimumDeposit.toLocaleString()),1)]),e("div",ct,[e("div",pt,[o(n,{prime:"",name:"percentage",size:"12",class:"text-mute p-1 rounded-full"}),s[15]||(s[15]=e("p",{class:"text-mute text-sm font-semibold"},"Expected Return Rate",-1))]),s[16]||(s[16]=e("p",{class:"text-xs text-mute font-medium"},"Non auto-compounded",-1)),e("p",vt,a(t.value.expectedReturnRate)+"%",1)]),t.value.autocompoundedReturnRate?(l(),m("div",ft,[e("div",_t,[o(n,{prime:"",name:"percentage",size:"12",class:"text-mute p-1 rounded-full"}),s[17]||(s[17]=e("p",{class:"text-mute text-sm font-semibold"},"Expected Return Rate",-1))]),s[18]||(s[18]=e("p",{class:"text-xs text-primary-500 font-medium"},"Auto-compounded",-1)),e("p",xt,a(t.value.autocompoundedReturnRate)+"%",1)])):_("",!0),e("div",bt,[e("div",ht,[o(n,{prime:"",name:"calendar-clock",size:"12",class:"text-mute p-1 rounded-full"}),s[19]||(s[19]=e("p",{class:"text-mute text-sm font-semibold"},"Duration",-1))]),e("p",gt,a(t.value.duration)+" days",1)]),e("div",yt,[e("div",kt,[o(n,{prime:"",name:"dollar",size:"12",class:"text-mute p-1 rounded-full"}),s[20]||(s[20]=e("p",{class:"text-mute text-sm font-semibold"},"Termination Fee",-1))]),e("p",wt," $"+a(t.value.terminationFee.toLocaleString()),1)])]),_:1}),o(i,{header:"Actions",class:"mt-2 grid gap-2"},{default:r(()=>[t.value.status==="open"?(l(),m("div",Dt,[e("div",Tt,[o(n,{prime:"",name:"times-circle",size:"12",class:"text-mute p-1 rounded-full"}),s[21]||(s[21]=e("p",{class:"text-mute text-sm font-semibold"},"Terminate Investment",-1))]),e("div",Rt,[o(R,{size:"small",severity:"error"},{default:r(()=>s[22]||(s[22]=[e("p",{class:"text-xs"},"You must provide a reason for the termination.",-1)])),_:1})]),o(c,{onTerminate:b,investment:t.value,class:"mt-2"},null,8,["investment"])])):(l(),m("div",$t,[e("div",zt,[o(n,{prime:"",name:"times-circle",size:"12",class:"text-mute p-1 rounded-full"}),s[23]||(s[23]=e("p",{class:"text-mute text-sm font-semibold"},"No Actions",-1))]),s[24]||(s[24]=e("p",{class:"mt-2 text-sm text-primary-500 font-medium"}," There are no actions to perform on this investment. ",-1))]))]),_:1})])])])):_("",!0)])])}}});export{Bt as default};
