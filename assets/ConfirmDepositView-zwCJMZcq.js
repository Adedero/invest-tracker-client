import{_ as K}from"./VCard.vue_vue_type_script_setup_true_lang-PTAvzsv6.js";import{a as Y,s as J}from"./index-B-fmEUJX.js";import{s as Q}from"./index-DrOr8a5z.js";import{_ as X}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-IRMrSdrb.js";import{_ as Z}from"./PageLoader-CVVMFRJU.js";import{f as ee,u as te,aA as ae,h as l,E as se,o,c as d,a as e,v as s,b as a,q as D,H as g,L as le,A as oe,O as ne,r as re,t as T,k as y,j as I,K as ue,s as ie}from"./index-CPQeoj50.js";import{_ as ce}from"./VNavbar.vue_vue_type_script_setup_true_lang-aTOVxp6y.js";import{u as R}from"./index-p30fdSMQ.js";import"./index-57mWwkce.js";import"./index-CyFKcpBt.js";import"./helpers-BF5XYaOm.js";const de={class:"h-full"},me={class:"flex-col-center gap-1"},pe={class:"mt-4 flex items-center justify-center"},fe={key:1,class:"flex-center"},_e={class:"text-center"},ve={key:2,class:"text-2xl font-semibold"},ge={key:3,class:"text-red-500"},ye={key:4},be={key:1,class:"mt-2 grid gap-y-3 gap-x-2 md:grid-cols-2"},we={class:"grid gap-1 md:col-span-2"},ke={class:"grid gap-1"},xe={class:"grid gap-1"},$e={class:"grid gap-1 md:col-span-2"},De={class:"text-sm font-semibold text-mute"},Ce={class:"mt-4 flex items-center gap-2 justify-end"},qe=ee({__name:"ConfirmDepositView",setup(he){const E=le(),m=oe(),U=te(),p=ae(),C=l(!1),{amount:r,type:b,symbol:V,currencySymbol:j}=E.query,u=l((b==null?void 0:b.toString().toLowerCase())==="wire-transfer"),L=l(!1),h=l(null),n=l(),N=async()=>{await R(`/user/currency-rate/${V}?amount=${r}`,{loading:L,error:h,config:{router:m,cache:!0}},i=>{n.value=i})},w=l(!1),S=l(null),f=l(),B=async()=>{await R(`/user/accounts/${U.user.id}?key=userId&field=walletBalance`,{loading:w,error:S,config:{router:m,cache:!0}},i=>{f.value=i.data.walletBalance})},P=l(!1),A=l(null),G=async()=>{if(u.value){const i={userId:U.user.id,amountInUSD:r,charge:0,actualAmountInUSD:r,amountInCurrency:r,rate:1,transactionType:"deposit",status:"pending",currency:"USD",isWireTransfer:!0,description:""};await R("user/transactions",{loading:P,error:A,config:{method:"POST",router:m,body:{data:i,addUserRelation:!0}}},()=>{C.value=!0});return}n.value&&(p.depositDetails.walletBalance=f.value,p.depositDetails.amount=n.value.amount,p.depositDetails.result=n.value.result,p.depositDetails.currency=n.value.currency,m.push({name:"deposit-preview"}))};return se(async()=>{if(p.depositDetails={},!r&&!b&&!V){await m.push({name:"deposit"});return}if(u.value){await B();return}await Promise.all([N(),B()])}),(i,t)=>{const W=ce,M=ue,_=ie,O=re("RouterLink"),z=ne,F=Z,q=X,v=Y,k=Q,x=J,H=K;return o(),d("div",de,[e(W),e(z,{visible:C.value,"onUpdate:visible":t[0]||(t[0]=$=>C.value=$),modal:"",closable:!1,header:"Wire Transfer",class:"w-80"},{default:s(()=>[a("div",me,[e(M,{name:"check_circle",size:"50",class:"text-emerald-500"}),t[2]||(t[2]=a("p",{class:"text-center"}," Your deposit request has been submitted and the details of the wire transfer will be sent to your email address shortly ",-1)),e(O,{to:{name:"wallet-history"},class:"mt-2 w-full"},{default:s(()=>[e(_,{label:"Continue",fluid:""})]),_:1})])]),_:1},8,["visible"]),a("div",pe,[L.value?(o(),D(F,{key:0})):h.value?(o(),d("div",fe,[e(q,{error:h.value,request:"GET",onRetry:N},null,8,["error"])])):g("",!0),e(H,{class:"w-full max-w-[28rem] md:!p-6"},{default:s(()=>{var $;return[a("div",_e,[w.value?(o(),D(_,{key:0,loading:w.value,label:"Loading Account Balance"},null,8,["loading"])):S.value?(o(),D(_,{key:1,severity:"danger",label:"Retry",onClick:B})):f.value?(o(),d("p",ve,"$"+T(f.value),1)):g("",!0),!w.value&&S.value?(o(),d("p",ge,"Failed to get account balance")):f.value?(o(),d("p",ye,"Account Balance")):g("",!0)]),A.value?(o(),D(q,{key:0,error:A.value},null,8,["error"])):g("",!0),u.value||n.value?(o(),d("div",be,[a("div",we,[t[5]||(t[5]=a("label",{class:"text-sm font-semibold text-mute"},"Deposit Amount in USD",-1)),e(x,{class:"w-full *:dark:bg-slate-800"},{default:s(()=>[e(v,null,{default:s(()=>t[3]||(t[3]=[y("$")])),_:1}),e(k,{value:I(r)??"00",readonly:"",class:"w-full *:dark:bg-slate-800"},null,8,["value"]),e(v,null,{default:s(()=>t[4]||(t[4]=[y(".00")])),_:1})]),_:1})]),a("div",ke,[t[7]||(t[7]=a("label",{class:"text-sm font-semibold text-mute"},"Rate",-1)),e(x,{class:"w-full *:dark:bg-slate-800"},{default:s(()=>{var c;return[e(v,null,{default:s(()=>t[6]||(t[6]=[y("$")])),_:1}),e(k,{value:u.value?1:(c=n.value)==null?void 0:c.currency.rate,readonly:"",class:"w-full *:dark:bg-slate-800"},null,8,["value"])]}),_:1})]),a("div",xe,[t[9]||(t[9]=a("label",{class:"text-sm font-semibold text-mute"},"Charges",-1)),e(x,{class:"w-full *:dark:bg-slate-800"},{default:s(()=>[e(v,null,{default:s(()=>t[8]||(t[8]=[y("$")])),_:1}),e(k,{value:"0",readonly:"",class:"w-full *:dark:bg-slate-800"})]),_:1})]),a("div",$e,[a("label",De,"Amount in "+T(u.value?"USD":($=n.value)==null?void 0:$.currency.abbr),1),e(x,{class:"w-full *:dark:bg-slate-800"},{default:s(()=>{var c;return[e(v,null,{default:s(()=>[y(T(u.value?"$":I(j)??"$"),1)]),_:1}),e(k,{value:u.value?I(r)??"00":(c=n.value)==null?void 0:c.result,readonly:"",class:"w-full *:dark:bg-slate-800"},null,8,["value"])]}),_:1})])])):g("",!0),a("div",Ce,[e(_,{onClick:t[1]||(t[1]=c=>i.$router.back()),label:"Cancel",severity:"secondary",class:"dark:bg-slate-700"}),e(_,{loading:P.value,onClick:G,label:"Proceed"},null,8,["loading"])])]}),_:1})])])}}});export{qe as default};
