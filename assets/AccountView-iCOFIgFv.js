import{f as Y,a2 as P,a3 as F,A as q,h as i,o as n,q as U,v as u,b as e,a as l,k as re,B as ue,O as A,u as O,c as y,H as S,j as N,K as W,s as H,D as de,E as me,L as ce,r as pe,t as f,a4 as ve,a5 as fe,p as _e}from"./index-CW21LfwU.js";import{_ as G}from"./VFileUploader.vue_vue_type_script_setup_true_lang-C6UUfPzy.js";import{s as J}from"./index-By7NwKG_.js";import{u as K}from"./index-Bco5Uctx.js";import{s as ge}from"./index-Diq0yfHp.js";import{_ as be}from"./VCard.vue_vue_type_script_setup_true_lang-BEXAQp5x.js";import{s as Q}from"./index-D1yCMm1e.js";import{_ as X}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-BjwNYmRP.js";import{c as ye}from"./country-by-name-Di7sd6fA.js";import{_ as xe}from"./PageLoader-CZ-Kt3Ck.js";import{_ as ke}from"./VNavbar.vue_vue_type_script_setup_true_lang-14B8tRi_.js";import{t as he,l as we}from"./helpers-BF5XYaOm.js";import{z as R}from"./index-ans_9-if.js";import"./index-Bl-tvBni.js";import"./index-C-BpVv3R.js";const Ve={class:"grid gap-4"},$e={class:"grid gap-2"},Ue={class:"grid gap-2"},Ce=Y({__name:"KycVerifier",props:P({accountId:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:P(["update"],["update:visible"]),setup(c,{emit:E}){const I=E,x=F(c,"visible"),k=q(),V=i(["International Passport","Driver's License","Voter's Card","National ID Card"]),a=i(),p=i(!1),T=i(null),$=async _=>{const t=_[0],h={kycIdType:a.value,kycDocument:t.dataUrl,kycDocumentExt:t.name.split(".").pop(),kycStatus:"pending",kycSubmittedAt:new Date,kycVerifiedAt:null};await K(`user/accounts/${c.accountId}`,{loading:p,error:T,config:{router:k,method:"PUT",body:{data:h}}},()=>{x.value=!1,I("update",h)})};return(_,t)=>{const h=ue,v=J,o=G,m=A;return n(),U(m,{visible:x.value,"onUpdate:visible":t[1]||(t[1]=g=>x.value=g),header:"KYC Verification",modal:"",class:"w-full max-w-96"},{default:u(()=>[e("div",Ve,[l(h,{size:"small",class:"mt-2"},{default:u(()=>t[2]||(t[2]=[re(" For a quicker verification process, please make sure the name on your ID matches your name on Invest Tracker. ")])),_:1}),e("div",$e,[t[3]||(t[3]=e("label",{for:"id-type",class:"text-mute text-sm font-medium"},"ID Type",-1)),l(v,{"label-id":"id-type",modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=g=>a.value=g),options:V.value},null,8,["modelValue","options"])]),e("div",Ue,[t[4]||(t[4]=e("label",{for:"kyc-document",class:"text-mute text-sm font-medium"},"Upload Document",-1)),t[5]||(t[5]=e("small",{class:"text-primary-500"},"Uploaded file must be 2 MB or less",-1)),l(o,{"input-id":"kyc-document","max-file-size":2*1024*1024,disabled:p.value||!a.value,onUpload:$,loading:p.value},null,8,["disabled","loading"])])])]),_:1},8,["visible"])}}}),De={key:0},Se={class:"grid gap-4"},Ee={class:"flex flex-col gap-2 items-center"},ze={class:"w-24 aspect-square rounded-full bg-slate-100 dark:bg-slate-800 overflow-hidden"},Ie=["src","alt"],Te={class:"my-2 w-full"},Me={class:"grid gap-2"},Be={class:"grid gap-2"},Ne={class:"grid gap-2"},Pe={class:"grid gap-2"},je={class:"grid gap-2"},Le=Y({__name:"UserProfileEditor",props:P({user:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:P(["update"],["update:visible"]),setup(c,{emit:E}){const I=q(),x=O(),k=F(c,"visible"),V=E,a=i({name:c.user.name,address:c.user.address,phoneNumber:c.user.phoneNumber,country:c.user.country,region:c.user.region,image:c.user.image}),p=i(a.value.country?{country:a.value.country}:null),T=v=>{a.value.image=v[0].dataUrl},$=i(!1),_=i(null),t=async()=>{var v;a.value.name&&((v=p.value)!=null&&v.country&&(a.value.country=p.value.country),await K(`user/users/${x.user.id}`,{loading:$,error:_,config:{router:I,method:"PUT",body:{data:a.value}}},()=>{x.user.name=a.value.name,x.user.image=a.value.image,k.value=!1,V("update",a.value)}))},h=()=>{a.value.image=null,t()};return(v,o)=>{const m=W,g=H,z=G,j=X,C=Q,b=J,s=A;return n(),y("div",null,[l(s,{visible:k.value,"onUpdate:visible":o[5]||(o[5]=d=>k.value=d),header:"Edit Details",modal:"",class:"w-full max-w-96"},{default:u(()=>[v.user?(n(),y("div",De,[e("div",Se,[e("div",Ee,[e("div",ze,[a.value.image?(n(),y("img",{key:0,src:a.value.image,alt:a.value.name,class:"w-full h-full object-cover"},null,8,Ie)):(n(),U(m,{key:1,name:"account_circle",size:"96"}))]),v.user.image?(n(),U(g,{key:0,label:"Remove image",onClick:h})):(n(),U(z,{key:1,size:"small",accept:"image/*","max-file-size":2*1024*1024,onSelect:T,onUpload:t,loading:$.value},null,8,["loading"]))]),e("div",Te,[_.value?(n(),U(j,{key:0,error:_.value},null,8,["error"])):S("",!0)]),e("div",Me,[o[6]||(o[6]=e("label",{for:"name",class:"text-mute text-sm font- medium"},"Name",-1)),l(C,{id:"name",modelValue:a.value.name,"onUpdate:modelValue":o[0]||(o[0]=d=>a.value.name=d)},null,8,["modelValue"])]),e("div",Be,[o[7]||(o[7]=e("label",{for:"phone-number",class:"text-mute text-sm font- medium"},"Phone Number",-1)),l(C,{id:"phone-number",modelValue:a.value.phoneNumber,"onUpdate:modelValue":o[1]||(o[1]=d=>a.value.phoneNumber=d)},null,8,["modelValue"])]),e("div",Ne,[o[8]||(o[8]=e("label",{for:"name",class:"text-mute text-sm font- medium"},"House Address",-1)),l(C,{id:"address",modelValue:a.value.address,"onUpdate:modelValue":o[2]||(o[2]=d=>a.value.address=d)},null,8,["modelValue"])]),e("div",Pe,[o[9]||(o[9]=e("label",{for:"country",class:"text-mute text-sm font- medium"},"Country",-1)),l(b,{modelValue:p.value,"onUpdate:modelValue":o[3]||(o[3]=d=>p.value=d),options:N(ye),editable:"","option-label":"country",fluid:"","show-clear":""},null,8,["modelValue","options"])]),e("div",je,[o[10]||(o[10]=e("label",{for:"region",class:"text-mute text-sm font- medium"},"State/Region",-1)),l(C,{id:"name",modelValue:a.value.region,"onUpdate:modelValue":o[4]||(o[4]=d=>a.value.region=d)},null,8,["modelValue"])]),e("div",null,[l(g,{onClick:t,label:"Submit",fluid:"",icon:"pi pi-check",disabled:$.value||!a.value.name},null,8,["disabled"])])])])):S("",!0)]),_:1},8,["visible"])])}}}),Ye={class:"h-full"},qe={class:"mt-2 overflow-y-auto md:h-[calc(100dvh-8rem)]"},Ae={key:1},Ke={key:2,class:"w-full h-full grid gap-2 md:grid-cols-7"},Re={class:"md:col-span-4 grid gap-2"},Fe={class:"flex items-center justify-end gap-2"},Oe={class:"grid gap-1"},We={key:0,class:"text-red-500"},He={class:"mt-2 flex items-center flex-col md:flex-row justify-center md:justify-normal gap-5 flex-wrap"},Ge={key:0,class:"bg-white rounded-full w-36 md:w-28 aspect-square overflow-hidden"},Je=["src","alt"],Qe={class:"font-semibold text-4xl md:5xl"},Xe={class:"flex flex-col gap-2 *:flex-shrink-0"},Ze={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},et={class:"flex items-center"},tt={class:"text-right font-semibold"},st={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},lt={class:"flex items-center"},at={class:"text-right font-semibold"},ot={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},it={class:"flex items-center"},nt={class:"text-right font-semibold"},rt={class:"md:col-span-3 md:row-span-6 flex flex-col gap-2 *:flex-shrink-0"},ut={class:"flex items-center gap-1"},dt={class:"mt-2"},mt={class:"text-3xl md:text-34xl font-semibold"},ct={class:"text-xl"},pt={class:"mt-3 flex items-center justify-end gap-2"},vt={class:"p-2 border rounded-lg dark:border-white/30 dark:bg-slate-800"},ft={class:"flex items-center"},_t={class:"mt-3 flex items-center gap-2 justify-between"},gt={key:0,class:"mt-4"},bt={class:"p-2 border rounded-lg dark:border-white/30 dark:bg-slate-800"},yt={class:"flex items-center"},xt={class:"mt-3 grid gap-2"},kt={class:"flex items-center justify-between gap-3 flex-wrap"},ht={key:0,class:"flex items-center justify-between gap-3 flex-wrap"},wt={class:"flex items-center gap-2 flex-wrap justify-between"},Vt=["href","download"],Yt=Y({__name:"AccountView",setup(c){var C;const E=q(),I=ce(),x=O(),k=i(((C=I.query.editProfile)==null?void 0:C.toString())==="true"),V=i(!1),a=i(!1),p=i(),T=i([{label:"Edit email address",icon:"pi pi-at",command:()=>a.value=!0},{label:"Edit other details",icon:"pi pi-user-edit",command:()=>k.value=!0}]),$=i(!1),_=i(null),t=i(null),h=async()=>{await K(`user/users/${x.user.id}?relation=account`,{loading:$,error:_,config:{router:E,cache:!0}},b=>{t.value=b.data})},v=b=>{t.value&&(t.value={...t.value,...b})},o={unverified:"danger",pending:"warn",verified:"success"},m=i(),g=de(()=>{var b;return!!m.value&&m.value===((b=t.value)==null?void 0:b.email)}),z=i(""),j=()=>{if(z.value="",!t.value||!m.value||g.value)return;const s=R.object({email:R.string({message:"Email is required"}).email({message:"Enter a valid email"})}).safeParse({email:m.value});if(!s.success){z.value=s.error.errors[0].message;return}E.push({name:"email-verification",query:{userId:t.value.id,email:btoa(m.value),emailSubject:"Invest Tracker Email Change"}})};return me(async()=>{await h()}),(b,s)=>{const d=ke,Z=xe,ee=X,w=H,te=fe,se=Q,le=A,ae=Le,D=W,M=be,oe=_e,L=pe("RouterLink"),ie=ge,ne=Ce;return n(),y("div",Ye,[l(d),e("div",qe,[$.value?(n(),U(Z,{key:0})):_.value?(n(),y("div",Ae,[l(ee,{error:_.value,request:"GET",onRetry:h},null,8,["error"])])):t.value?(n(),y("div",Ke,[e("div",Re,[l(M,{class:"bg-gradient-y text-white"},{header:u(()=>[e("div",Fe,[l(w,{onClick:s[0]||(s[0]=r=>{var B;return(B=p.value)==null?void 0:B.toggle(r)}),size:"small",label:"Edit",icon:"pi pi-user-edit",class:"border-white bg-white text-primary-500"}),l(te,{ref_key:"menu",ref:p,model:T.value,popup:!0},null,8,["model"]),l(le,{visible:a.value,"onUpdate:visible":s[2]||(s[2]=r=>a.value=r),header:"Change Email",modal:"",class:"w-80"},{default:u(()=>[e("div",null,[e("div",Oe,[s[8]||(s[8]=e("label",{for:"email",class:"text-mute font-medium text-sm"}," Enter your new email address ",-1)),s[9]||(s[9]=e("small",{class:"text-primary-500"},"You will be asked to verify this email address.",-1)),l(se,{modelValue:m.value,"onUpdate:modelValue":s[1]||(s[1]=r=>m.value=r),modelModifiers:{trim:!0},fluid:""},null,8,["modelValue"]),g.value||z.value?(n(),y("small",We,f(z.value||"Your new email is the same as your current email."),1)):S("",!0)]),l(w,{onClick:j,disabled:!m.value||g.value,label:"Proceed",icon:"pi pi-arrow-right","icon-pos":"right",fluid:"",class:"mt-4"},null,8,["disabled"])])]),_:1},8,["visible"]),l(ae,{visible:k.value,"onUpdate:visible":s[3]||(s[3]=r=>k.value=r),user:t.value,onUpdate:v},null,8,["visible","user"])])]),default:u(()=>[e("div",He,[t.value.image?(n(),y("div",Ge,[e("img",{src:t.value.image,alt:t.value.name,class:"w-full h-full object-cover"},null,8,Je)])):(n(),U(D,{key:1,name:"account_circle",size:"120"})),e("div",null,[e("h1",Qe,f(t.value.name),1),e("p",null,f(t.value.email),1)])])]),_:1}),l(M,{class:"grid gap-2",header:"Profile"},{default:u(()=>[e("div",Xe,[e("div",Ze,[e("div",et,[l(D,{prime:"",name:"phone",size:"12",class:"text-mute p-1 rounded-full"}),s[10]||(s[10]=e("p",{class:"text-mute text-sm font-semibold"},"Phone Number",-1))]),e("p",tt,f(t.value.phoneNumber||"----------"),1)]),e("div",st,[e("div",lt,[l(D,{prime:"",name:"map",size:"12",class:"text-mute p-1 rounded-full"}),s[11]||(s[11]=e("p",{class:"text-mute text-sm font-semibold"},"Address",-1))]),e("p",at,f(t.value.address||"----------"),1)]),e("div",ot,[e("div",it,[l(D,{prime:"",name:"map-marker",size:"12",class:"text-mute p-1 rounded-full"}),s[12]||(s[12]=e("p",{class:"text-mute text-sm font-semibold"},"Location",-1))]),e("p",nt,f(t.value.region||"_____")+", "+f(t.value.country||"_____"),1)]),l(oe),e("div",null,[l(L,{to:{name:"change-password"}},{default:u(()=>[l(w,{fluid:"",label:"Change Password",icon:"pi pi-key"})]),_:1})])])]),_:1})]),e("div",rt,[l(M,{header:"Wallet Balance"},{header:u(()=>[e("div",ut,[l(D,{name:"attach_money",size:"18",class:"bg-primary-500 text-white p-1 rounded-full aspect-square"}),s[13]||(s[13]=e("p",{class:"font-semibold"},"Wallet Balance",-1))])]),default:u(()=>{var r,B;return[e("div",dt,[e("p",mt," $"+f(((r=t.value.account)==null?void 0:r.walletBalance.toLocaleString().split(".")[0])??"00"),1),e("p",ct," ."+f(((B=t.value.account)==null?void 0:B.walletBalance.toLocaleString().split(".")[1])??"00"),1)]),e("div",pt,[l(L,{to:{name:"deposit"}},{default:u(()=>[l(w,{size:"small",label:"Deposit",class:"bg-gradient-x"})]),_:1}),l(L,{to:{name:"withdraw"}},{default:u(()=>[l(w,{severity:"secondary",size:"small",label:"Withdraw",class:"dark:bg-slate-800 dark:border-slate-800"})]),_:1})])]}),_:1}),l(M,{header:"KYC Verification"},{default:u(()=>[e("div",vt,[e("div",ft,[l(D,{prime:"",name:"user",size:"12",class:"text-mute p-1 rounded-full"}),s[14]||(s[14]=e("p",{class:"text-mute text-sm font-semibold"},"KYC Verification Status",-1))]),e("div",_t,[l(ie,{severity:o[t.value.account.kycStatus],value:N(he)(t.value.account.kycStatus)},null,8,["severity","value"]),t.value.account.kycStatus==="unverified"?(n(),U(w,{key:0,onClick:s[4]||(s[4]=r=>V.value=!0),size:"small",class:"text-sm py-1",label:"Start Verification"})):S("",!0),l(ne,{"account-id":t.value.account.id,visible:V.value,"onUpdate:visible":s[5]||(s[5]=r=>V.value=r),onUpdate:s[6]||(s[6]=r=>t.value&&(t.value.account={...t.value.account,...r}))},null,8,["account-id","visible"])])]),t.value.account.kycStatus!=="unverified"?(n(),y("div",gt,[e("div",bt,[e("div",yt,[l(D,{prime:"",name:"user",size:"12",class:"text-mute p-1 rounded-full"}),s[15]||(s[15]=e("p",{class:"text-mute text-sm font-semibold"},"KYC Document",-1))]),e("div",xt,[e("div",kt,[s[16]||(s[16]=e("p",null,"ID Type",-1)),e("p",null,f(t.value.account.kycIdType),1)]),t.value.account.kycVerifiedAt?(n(),y("div",ht,[s[17]||(s[17]=e("p",null,"Verified On",-1)),e("p",null,f(N(ve)(t.value.account.kycVerifiedAt,"ddd, MMM DD, YYYY")),1)])):S("",!0),e("div",wt,[l(w,{onClick:s[7]||(s[7]=r=>V.value=!0),label:"Update",icon:"pi pi-file-edit",size:"small"}),e("a",{href:t.value.account.kycDocument,download:`${t.value.account.id}.${t.value.account.kycDocumentExt}`},[l(w,{label:"Download",icon:"pi pi-download",size:"small",outlined:""})],8,Vt)])])])])):S("",!0)]),_:1}),l(M,{header:"Log Out"},{default:u(()=>[l(w,{onClick:N(we),fluid:"",label:"Log out",outlined:"",icon:"pi pi-sign-out outlined",severity:"danger"},null,8,["onClick"])]),_:1})])])):S("",!0)])])}}});export{Yt as default};
