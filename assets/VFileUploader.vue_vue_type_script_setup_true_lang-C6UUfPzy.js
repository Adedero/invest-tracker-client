import{f as N,h as F,D as V,G as x,o as y,c as w,a6 as U,a7 as I,a as z,v as b,q as L,b as r,t as f,n as h,B as M,s as $,k as D}from"./index-CW21LfwU.js";const j={class:"flex flex-col items-center justify-center *:flex-shrink-0"},E=["for"],A={key:1,class:"grid grid-cols-2 gap-2 w-full"},G=["id","accept","multiple"],R=N({__name:"VFileUploader",props:{accept:{},invalidFileSizeMessage:{},invalidFileTypeMessage:{},maxFileSize:{},maxFileNumber:{},buttonType:{default:"primary"},chooseLabel:{default:"Choose"},uploadLabel:{default:"Upload"},multiple:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},inputId:{default:"v-file-uploader"},disabled:{type:Boolean,default:!1},size:{}},emits:["cancel","select","upload"],setup(i,{emit:B}){const m=B,l=F(null),s=F({}),S=async e=>{s.value={};const t=e.target,o=t==null?void 0:t.files;if(!o){s.value={error:!0,message:"No files selected."};return}if(l.value=Array.from(o),i.maxFileNumber){const a=parseInt(i.maxFileNumber.toString(),10);if(l.value.length>a){l.value=null,s.value={error:!0,message:`Only ${a} files can be uploaded.`};return}}if(i.accept&&!l.value.every(n=>{var c,p,d;const u=n.type,g=(d=(p=(c=n==null?void 0:n.name)==null?void 0:c.split("."))==null?void 0:p.pop())==null?void 0:d.toLowerCase();return u.match(i.accept)||i.accept.includes(g??"")})){l.value=null,s.value={error:!0,message:i.invalidFileTypeMessage||"File format is not allowed."};return}if(i.maxFileSize){const a=T(i.maxFileSize);if(!l.value.every(u=>u.size<=i.maxFileSize)){l.value=null,s.value={error:!0,message:i.invalidFileSizeMessage||`File size exceeds the ${a} limit.`};return}}s.value={error:!1,message:""};for await(const a of l.value){const n=new FileReader,u=await new Promise((g,c)=>{n.readAsDataURL(a),n.onload=p=>{var d;g((d=p.target)==null?void 0:d.result)},n.onerror=()=>{c(new Error("File reading failed"))}});a.dataUrl=u}m("select",l.value)},C=()=>{if(l.value){const e=l.value;m("upload",e),l.value=null}},v=()=>{l.value=null,s.value={error:!1,message:""},m("cancel")},k=V(()=>l.value?l.value.length>1?`${l.value.length} files selected`:l.value[0].name:"No files selected");function T(e){const t=["Bytes","KB","MB","GB","TB","PB"];let o=0,a=e;for(;a>=1024&&o<t.length-1;)a/=1024,o++;return`${a.toFixed(1)} ${t[o]}`}return x(()=>{v()}),(e,t)=>{const o=M,a=$;return y(),w("div",j,[U(z(o,{severity:"error",closable:"",class:"w-full mb-2"},{default:b(()=>[D(f(s.value.message),1)]),_:1},512),[[I,s.value.error]]),l.value?(y(),w("div",A,[z(a,{onClick:v,size:e.size,severity:"secondary",label:"Cancel",icon:"pi pi-times-circle"},null,8,["size"]),z(a,{onClick:C,icon:"pi pi-upload",severity:e.buttonType,style:{padding:"0",width:"100%"},loading:e.loading,disabled:e.loading||e.disabled,size:e.size},{default:b(()=>[r("div",{class:h(["font-semibold flex items-center justify-center gap-2 cursor-pointer w-full p-2",{"cursor-context-menu":e.disabled,"!p-1":e.size==="small"}])},[r("span",{class:h(e.loading?"pi pi-spinner pi-spin":"pi pi-plus")},null,2),r("span",null,f(e.uploadLabel),1)],2)]),_:1},8,["severity","loading","disabled","size"])])):(y(),L(a,{key:0,icon:"pi pi-upload",severity:e.buttonType,fluid:"",style:{padding:"0",width:"100%"},loading:e.loading,size:e.size},{default:b(()=>[r("label",{for:e.inputId,class:"font-semibold flex items-center justify-center gap-2 cursor-pointer w-full p-2"},[t[0]||(t[0]=r("span",{class:"pi pi-upload"},null,-1)),r("span",null,f(e.chooseLabel),1)],8,E)]),_:1},8,["severity","loading","size"])),r("p",{class:h([{"text-slate-500":!l.value},"mt-2 max-w-60 text-center font-medium font-600 text-sm truncate"])},f(k.value),3),r("input",{id:e.inputId,onInput:S,onCancel:v,type:"file",accept:e.accept,multiple:e.multiple,class:"hidden"},null,40,G)])}}});export{R as _};
