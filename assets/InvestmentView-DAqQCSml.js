import{f as S,A as Y,ag as N,af as j,h as f,o as l,c as d,b as e,I as B,a,v as m,k as E,t as n,s as V,O as U,D as M,H as w,E as G,q as P,j as $,a4 as z,B as K,K as O}from"./index-BeBYLbm4.js";import{s as J}from"./index-CROb7Z2g.js";import{s as q}from"./index-DOW5xzdw.js";import{u as L}from"./index-CODlRzTV.js";import{s as Q}from"./index-ClWOIhms.js";import{_ as W}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-CC07B55Y.js";import{_ as X}from"./PageLoader-ASoPjOmp.js";import{_ as Z}from"./VCard.vue_vue_type_script_setup_true_lang-BSr0I-Iy.js";import{t as F}from"./helpers-BF5XYaOm.js";import"./index-Dnf1wTNt.js";import"./index-Ca6bNHhN.js";const ee={class:"grid gap-1"},te={class:"mt-4 flex items-center gap-2 flex-wrap"},se={for:"apply-fee",class:"text-sm text-mute font-medium"},ae={class:"mt-4 flex items-center gap-3 justify-end"},ne="admin",oe=S({__name:"InvestmentTerminator",props:{investment:{}},emits:["terminate"],setup(g,{emit:D}){const I=D,t=Y(),T=N(),R=j(),p=f(!1),h=f(""),y=f(!1),_=f(!1),b=f();async function c(){const x={status:"terminated",terminationReason:h.value,terminator:ne,terminationFeeApplied:y.value,terminatedAt:new Date().toString()};if(await L(`admin/investments/${g.investment.id}`,{loading:_,error:b,config:{router:t,method:"PATCH",body:x}},o=>{I("terminate",o.data),T.add({severity:"success",summary:"Done",detail:"Investment terminated.",life:3e3}),r()}),b.value){T.add({severity:"error",summary:"Failed",detail:b.value.message,life:6e3});return}}const s=()=>{R.require({header:"Confirm Investment Termination",message:"Are you sure you want to proceed? This action cannot be reversed.",rejectProps:{severity:"secondary",label:"Cancel"},acceptProps:{severity:"danger",label:"Terminate"},reject:()=>{r()},accept:()=>{c()}})};function r(){h.value="",y.value=!1,p.value=!1}return(x,o)=>{const u=V,k=q,i=J,C=U;return l(),d("div",null,[e("div",{onClick:o[0]||(o[0]=v=>p.value=!0),class:"cursor-pointer"},[B(x.$slots,"default",{},()=>[a(u,{label:"Terminate Investment",icon:"pi pi-chevron-right","icon-pos":"right",size:"small",fluid:"",severity:"danger"})])]),e("div",null,[a(C,{visible:p.value,"onUpdate:visible":o[3]||(o[3]=v=>p.value=v),modal:"",header:"Terminate Investment",class:"w-80",onHide:r},{default:m(()=>[e("div",null,[e("div",ee,[o[4]||(o[4]=e("label",{for:"reason",class:"text-sm text-mute font-medium"},[E(" Reason for termination "),e("span",{class:"text-red-500"},"*")],-1)),a(k,{modelValue:h.value,"onUpdate:modelValue":o[1]||(o[1]=v=>h.value=v),modelModifiers:{trim:!0},fluid:"",col:"5",class:"resize-none",id:"reason"},null,8,["modelValue"])]),e("div",te,[a(i,{binary:"",modelValue:y.value,"onUpdate:modelValue":o[2]||(o[2]=v=>y.value=v),id:"apply-fee"},null,8,["modelValue"]),e("label",se," Apply $"+n(x.investment.terminationFee.toLocaleString())+" termination fee ",1)]),e("div",ae,[a(u,{onClick:r,label:"Cancel",severity:"secondary"}),a(u,{loading:_.value,disabled:_.value||!h.value,onClick:s,label:"Terminate",severity:"danger"},null,8,["loading","disabled"])])])]),_:1},8,["visible"])])])}}}),ie={key:0},le={class:"grid gap-1"},re={key:1},de={class:"mt-4 flex items-center gap-3 justify-end"},me=S({__name:"InvestmentPauseToggler",props:{investment:{}},emits:["toggle"],setup(g,{emit:D}){const I=D,t=Y(),T=N(),R=j(),p=f(!1),h=M(()=>g.investment.status==="open"?"Pause Investment":"Resume Investment"),y=M(()=>g.investment.status==="open"?!_.value:!1),_=f(""),b=f(!1),c=f();async function s(){let o=null;if(g.investment.status==="open"?o={status:"paused",pausedReason:_.value,pausedAt:new Date().toString(),isPausing:!0}:o={status:"open",pausedReason:null,pausedAt:null,isPausing:!1},await L(`admin/investments/${g.investment.id}`,{loading:b,error:c,config:{router:t,method:"PUT",body:{data:o}}},u=>{I("toggle",o),T.add({severity:"success",summary:"Done",detail:`Investment ${g.investment.status==="open"?"paused":"resumed"}.`,life:3e3}),x()}),c.value){T.add({severity:"error",summary:"Failed",detail:c.value.message,life:6e3});return}}const r=()=>{if(g.investment.status==="paused"){s();return}R.require({header:"Confirm Investment Pause",message:"Are you sure you want to proceed?",rejectProps:{severity:"secondary",label:"Cancel"},acceptProps:{severity:"warn",label:"Pause"},reject:()=>{x()},accept:()=>{s()}})};function x(){_.value="",p.value=!1}return(o,u)=>{const k=V,i=q,C=U;return l(),d("div",null,[e("div",{onClick:u[0]||(u[0]=v=>p.value=!0),class:"cursor-pointer"},[B(o.$slots,"default",{},()=>[a(k,{label:o.investment.status==="paused"?"Resume Investment":"Pause Investment",icon:"pi pi-chevron-right","icon-pos":"right",size:"small",fluid:"",severity:o.investment.status==="paused"?"":"warn"},null,8,["label","severity"])])]),e("div",null,[a(C,{visible:p.value,"onUpdate:visible":u[2]||(u[2]=v=>p.value=v),modal:"",header:h.value,class:"w-80",onHide:x},{default:m(()=>[e("div",null,[o.investment.status==="open"?(l(),d("div",ie,[e("div",le,[u[3]||(u[3]=e("label",{for:"reason",class:"text-sm text-mute font-medium"},[E(" Reason for pausing this investment "),e("span",{class:"text-red-500"},"*")],-1)),a(i,{modelValue:_.value,"onUpdate:modelValue":u[1]||(u[1]=v=>_.value=v),modelModifiers:{trim:!0},fluid:"",col:"5",class:"resize-none",id:"reason"},null,8,["modelValue"])])])):o.investment.status==="paused"?(l(),d("div",re," Are you sure you want to resume this investment? ")):w("",!0),e("div",de,[a(k,{onClick:x,label:"Cancel",severity:"secondary"}),a(k,{loading:b.value,disabled:b.value||y.value,onClick:r,label:o.investment.status==="paused"?"Resume":"Continue"},null,8,["loading","disabled","label"])])])]),_:1},8,["visible","header"])])])}}}),ue={class:"text-lg font-semibold text-primary-500"},ce={class:"text-sm"},ve={class:"mt-2"},pe={key:2},fe={class:"md:h-[calc(100dvh-8.5rem)] grid md:grid-cols-3 gap-2"},_e={class:"md:h-full md:overflow-y-auto md:col-span-2"},xe={class:"grid gap-2 md:grid-cols-3"},be={class:"text-xl font-semibold"},ge={class:"text-sm"},he={class:"text-xl font-semibold"},ye={class:"text-sm"},ke={class:"text-xs font-medium text-mute"},we={class:"text-xl font-semibold"},Te={class:"text-sm"},De={class:"text-xs font-medium text-mute"},Re={key:0},$e={key:1},Ie={class:"text-xl font-semibold"},Ce={key:0},ze={key:1},Ae={class:"grid gap-2"},Pe={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Me={class:"flex items-center"},Se={class:"text-right font-semibold"},Ye={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Ve={class:"flex items-center"},Le={class:"text-right font-semibold"},Fe={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Ne={class:"flex items-center"},je={class:"text-right font-semibold"},Be={key:0,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Ee={class:"flex items-center"},Ue={class:"text-right font-semibold"},qe={key:1,class:"contents"},He={key:0,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Ge={class:"flex items-center"},Ke={class:"text-right font-semibold"},Oe={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Je={class:"flex items-center"},Qe={class:"text-right font-semibold"},We={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Xe={class:"flex items-center"},Ze={class:"text-right font-semibold"},et={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},tt={class:"flex items-center"},st={class:"text-right font-semibold"},at={class:"md:h-full md:overflow-y-auto"},nt={class:"flex flex-col items-center justify-center gap-2 text-center"},ot={class:"w-32 aspect-square rounded-full overflow-hidden bg-slate-200 dark:bg-slate-800"},it=["src"],lt={class:"font-semibold md:text-lg"},rt={class:"text-sm text-mute"},dt={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},mt={class:"flex items-center"},ut={class:"text-right font-semibold"},ct={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},vt={class:"flex items-center"},pt={class:"text-right font-semibold"},ft={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},_t={class:"flex items-center"},xt={class:"text-right font-semibold"},bt={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},gt={class:"flex items-center"},ht={class:"text-right font-semibold"},yt={key:0,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},kt={class:"flex items-center"},wt={class:"text-right font-semibold"},Tt={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Dt={class:"flex items-center"},Rt={class:"text-right font-semibold"},$t={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},It={class:"flex items-center"},Ct={class:"text-right font-semibold"},zt={key:0,class:"grid gap-3"},At={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Pt={class:"flex items-center"},Mt={class:"text-mute text-sm font-semibold"},St={key:0,class:"my-1"},Yt={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Vt={class:"flex items-center"},Lt={class:"my-1"},Ft={key:1,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Nt={class:"flex items-center"},Wt=S({__name:"InvestmentView",setup(g){var b;const D=Y(),I=(b=D.currentRoute.value.params.investmentId)==null?void 0:b.toString(),t=f(),T=f(!1),R=f();async function p(){await L(`admin/investments/${I}?relation=user`,{loading:T,error:R,config:{router:D,cache:!0}},c=>{t.value=c.data})}const h=M(()=>t.value?parseFloat((t.value.currentTotalReturns/t.value.initialDeposit*100).toFixed(2)):0),y=c=>{t.value={...t.value,...c}};function _(c){return c==="open"?"success":c==="closed"?"info":"danger"}return G(async()=>{await p()}),(c,s)=>{const r=Z,x=X,o=W,u=Q,k=K,i=O,C=V,v=me,H=oe;return l(),d("div",null,[a(r,{class:"p-2"},{default:m(()=>{var A;return[e("div",ue,[s[1]||(s[1]=e("span",null,"Investment ",-1)),e("span",ce,"ID: "+n((A=t.value)==null?void 0:A.id),1)])]}),_:1}),e("div",ve,[T.value?(l(),P(x,{key:0})):R.value?(l(),P(o,{key:1,error:R.value,request:"GET",onRetry:p},null,8,["error"])):t.value?(l(),d("div",pe,[e("div",fe,[e("div",_e,[e("div",xe,[a(r,{header:"Deposit"},{default:m(()=>[e("div",be,[e("span",null," $"+n(t.value.initialDeposit.toLocaleString().split(".")[0])+".",1),e("span",ge,n(t.value.initialDeposit.toLocaleString().split(".")[1]??"00"),1)]),s[2]||(s[2]=e("p",{class:"text-xs font-medium text-mute"},"Initial deposit amount",-1))]),_:1}),a(r,{header:"Current Total Returns"},{default:m(()=>[e("div",he,[e("span",null," $"+n(t.value.currentTotalReturns.toLocaleString().split(".")[0])+". ",1),e("span",ye,n(t.value.currentTotalReturns.toLocaleString().split(".")[1]??"00"),1)]),e("p",ke,n(h.value)+"% of initial deposit ",1)]),_:1}),a(r,{header:"Last Return"},{default:m(()=>[e("div",we,[e("span",null," $"+n(t.value.lastProfitAmount.toLocaleString().split(".")[0])+".",1),e("span",Te,n(t.value.lastProfitAmount.toLocaleString().split(".")[1]??"00"),1)]),e("p",De,[t.value.lastProfitDistributedAt?(l(),d("span",Re,n($(z)(new Date(t.value.lastProfitDistributedAt),"ddd, DD MMM, YYYY hh:mm aa")),1)):(l(),d("span",$e,"No profit distributed yet"))])]),_:1}),a(r,{header:"Status"},{default:m(()=>[a(u,{class:"font-semibold",severity:_(t.value.status),value:$(F)(t.value.status)},null,8,["severity","value"])]),_:1}),a(r,{header:"Days Completed"},{default:m(()=>[e("div",Ie,[e("span",null,n(t.value.daysCompleted),1),s[3]||(s[3]=e("span",{class:"text-sm"}," Days ",-1))])]),_:1}),a(r,{header:"Auto-compounding"},{default:m(()=>[a(u,{class:"font-semibold",severity:t.value.autocompounded?"success":"warn",value:t.value.autocompounded?"Enabled":"Disabled"},null,8,["severity","value"])]),_:1})]),a(r,{header:"Daily Returns",class:"mt-2"},{default:m(()=>[a(k,{size:"small",class:"text-sm",icon:"pi pi-info-circle"},{default:m(()=>[t.value.autocompounded?(l(),d("p",Ce," The daily returns from this investment "+n(t.value.status==="open"?"are":"were")+" withheld and "+n(t.value.status==="open"?"will be":"were")+" added to the client's wallet balance when the investment is closed or terminated. ",1)):(l(),d("p",ze," The returns from this investment "+n(t.value.status==="open"?"are":"were")+" added to the client's wallet balance on a daily basis until the investment was closed or terminated. ",1))]),_:1})]),_:1}),a(r,{header:"Details",class:"mt-2"},{default:m(()=>[e("div",Ae,[e("div",Pe,[e("div",Me,[a(i,{prime:"",name:"dollar",size:"12",class:"text-mute p-1 rounded-full"}),s[4]||(s[4]=e("p",{class:"text-mute text-sm font-semibold"},"Expected Total Returns",-1))]),e("p",Se," $"+n(t.value.expectedTotalReturns.toLocaleString()),1)]),e("div",Ye,[e("div",Ve,[a(i,{prime:"",name:"dollar",size:"12",class:"text-mute p-1 rounded-full"}),s[5]||(s[5]=e("p",{class:"text-mute text-sm font-semibold"},"Current Total Returns",-1))]),e("p",Le," $"+n(t.value.currentTotalReturns.toLocaleString()),1)]),e("div",Fe,[e("div",Ne,[a(i,{prime:"",name:"calendar",size:"12",class:"text-mute p-1 rounded-full"}),s[6]||(s[6]=e("p",{class:"text-mute text-sm font-semibold"},"Created Date",-1))]),e("p",je,n($(z)(new Date(t.value.createdAt),"ddd, DD MMM, YYYY hh:mm aa")),1)]),t.value.status==="closed"&&t.value.closedAt?(l(),d("div",Be,[e("div",Ee,[a(i,{prime:"",name:"dollar",size:"12",class:"text-mute p-1 rounded-full"}),s[7]||(s[7]=e("p",{class:"text-mute text-sm font-semibold"},"Closed Date",-1))]),e("p",Ue,n($(z)(new Date(t.value.closedAt),"ddd, DD MMM, YYYY hh:mm aa")),1)])):w("",!0),t.value.status==="terminated"?(l(),d("div",qe,[t.value.terminatedAt?(l(),d("div",He,[e("div",Ge,[a(i,{prime:"",name:"calendar",size:"12",class:"text-mute p-1 rounded-full"}),s[8]||(s[8]=e("p",{class:"text-mute text-sm font-semibold"},"Terminated Date",-1))]),e("p",Ke,n($(z)(new Date(t.value.terminatedAt),"ddd, DD MMM, YYYY hh:mm aa")),1)])):w("",!0),e("div",Oe,[e("div",Je,[a(i,{prime:"",name:"info-circle",size:"12",class:"text-mute p-1 rounded-full"}),s[9]||(s[9]=e("p",{class:"text-mute text-sm font-semibold"},"Terminated Fee",-1))]),e("p",Qe,n(t.value.terminationFeeApplied?"Applied":"Not applied"),1)]),e("div",We,[e("div",Xe,[a(i,{prime:"",name:"info-circle",size:"12",class:"text-mute p-1 rounded-full"}),s[10]||(s[10]=e("p",{class:"text-mute text-sm font-semibold"},"Terminated By",-1))]),e("p",Ze,n($(F)(t.value.terminator)||"No terminator indicated"),1)]),e("div",et,[e("div",tt,[a(i,{prime:"",name:"info-circle",size:"12",class:"text-mute p-1 rounded-full"}),s[11]||(s[11]=e("p",{class:"text-mute text-sm font-semibold"},"Termination Reason",-1))]),e("p",st,n(t.value.terminationReason||"No reason provided"),1)])])):w("",!0)])]),_:1})]),e("div",at,[t.value.user?(l(),P(r,{key:0,header:"User"},{default:m(()=>[e("div",nt,[e("div",ot,[t.value.user.image?(l(),d("img",{key:0,src:t.value.user.image,class:"w-full h-full object-cover"},null,8,it)):w("",!0),a(i,{name:"account_circle",size:"8rem",class:"text-primary-500"})]),e("div",null,[e("p",lt,n(t.value.user.name),1),e("p",rt,n(t.value.user.email),1)]),a(C,{onClick:s[0]||(s[0]=A=>$(D).push({name:"admin-user",params:{userId:t.value.user.id}})),label:"Profile",icon:"pi pi-user",outlined:""})])]),_:1})):w("",!0),a(r,{header:"Investment Plan Details",class:"mt-2 grid gap-2"},{default:m(()=>[e("div",dt,[e("div",mt,[a(i,{prime:"",name:"info-circle",size:"12",class:"text-mute p-1 rounded-full"}),s[12]||(s[12]=e("p",{class:"text-mute text-sm font-semibold"},"Investment Name",-1))]),e("p",ut,n(t.value.investmentName),1)]),e("div",ct,[e("div",vt,[a(i,{prime:"",name:"sitemap",size:"12",class:"text-mute p-1 rounded-full"}),s[13]||(s[13]=e("p",{class:"text-mute text-sm font-semibold"},"Investment Tier",-1))]),e("p",pt,n(t.value.investmentTier),1)]),e("div",ft,[e("div",_t,[a(i,{prime:"",name:"money-bill",size:"12",class:"text-mute p-1 rounded-full"}),s[14]||(s[14]=e("p",{class:"text-mute text-sm font-semibold"},"Minimum Deposit",-1))]),e("p",xt," $"+n(t.value.minimumDeposit.toLocaleString()),1)]),e("div",bt,[e("div",gt,[a(i,{prime:"",name:"percentage",size:"12",class:"text-mute p-1 rounded-full"}),s[15]||(s[15]=e("p",{class:"text-mute text-sm font-semibold"},"Expected Return Rate",-1))]),s[16]||(s[16]=e("p",{class:"text-xs text-mute font-medium"},"Non auto-compounded",-1)),e("p",ht,n(t.value.expectedReturnRate)+"%",1)]),t.value.autocompoundedReturnRate?(l(),d("div",yt,[e("div",kt,[a(i,{prime:"",name:"percentage",size:"12",class:"text-mute p-1 rounded-full"}),s[17]||(s[17]=e("p",{class:"text-mute text-sm font-semibold"},"Expected Return Rate",-1))]),s[18]||(s[18]=e("p",{class:"text-xs text-primary-500 font-medium"},"Auto-compounded",-1)),e("p",wt,n(t.value.autocompoundedReturnRate)+"%",1)])):w("",!0),e("div",Tt,[e("div",Dt,[a(i,{prime:"",name:"calendar-clock",size:"12",class:"text-mute p-1 rounded-full"}),s[19]||(s[19]=e("p",{class:"text-mute text-sm font-semibold"},"Duration",-1))]),e("p",Rt,n(t.value.duration)+" days",1)]),e("div",$t,[e("div",It,[a(i,{prime:"",name:"dollar",size:"12",class:"text-mute p-1 rounded-full"}),s[20]||(s[20]=e("p",{class:"text-mute text-sm font-semibold"},"Termination Fee",-1))]),e("p",Ct," $"+n(t.value.terminationFee.toLocaleString()),1)])]),_:1}),a(r,{header:"Actions",class:"mt-2 grid gap-2"},{default:m(()=>[t.value.status==="open"||t.value.status==="paused"?(l(),d("div",zt,[e("div",At,[e("div",Pt,[a(i,{prime:"",name:t.value.status==="open"?"pause-circle":"play-circle",size:"12",class:"text-mute p-1 rounded-full"},null,8,["name"]),e("p",Mt,n(t.value.status==="open"?"Pause":"Resume")+" Investment",1)]),t.value.status==="open"?(l(),d("div",St,[a(k,{size:"small",severity:"warn"},{default:m(()=>s[21]||(s[21]=[e("p",{class:"text-xs"},"You must provide a reason for the pause.",-1)])),_:1})])):w("",!0),a(v,{onToggle:y,investment:t.value,class:"mt-2"},null,8,["investment"])]),e("div",Yt,[e("div",Vt,[a(i,{prime:"",name:"times-circle",size:"12",class:"text-mute p-1 rounded-full"}),s[22]||(s[22]=e("p",{class:"text-mute text-sm font-semibold"},"Terminate Investment",-1))]),e("div",Lt,[a(k,{size:"small",severity:"error"},{default:m(()=>s[23]||(s[23]=[e("p",{class:"text-xs"},"You must provide a reason for the termination.",-1)])),_:1})]),a(H,{onTerminate:y,investment:t.value,class:"mt-2"},null,8,["investment"])])])):(l(),d("div",Ft,[e("div",Nt,[a(i,{prime:"",name:"times-circle",size:"12",class:"text-mute p-1 rounded-full"}),s[24]||(s[24]=e("p",{class:"text-mute text-sm font-semibold"},"No Actions",-1))]),s[25]||(s[25]=e("p",{class:"mt-2 text-sm text-primary-500 font-medium"}," There are no actions to perform on this investment. ",-1))]))]),_:1})])])])):w("",!0)])])}}});export{Wt as default};
