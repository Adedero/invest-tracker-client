import{f as h,h as i,o as u,c as d,a,b as s,k as r,v as c,H as y,l as V,r as C,B as E,s as B,A as F,t as I}from"./index-CPQeoj50.js";import{s as N}from"./index-DrOr8a5z.js";import{F as p,u as S}from"./index-p30fdSMQ.js";import{z as f}from"./index-ans_9-if.js";import"./index-57mWwkce.js";import"./index-CyFKcpBt.js";const L={class:"w-full md:w-[26rem] h-full md:p-10 md:bg-white dark:bg-transparent"},P={class:"mt-8"},R={class:"mt-2 text-sm text-mute"},$={key:0,class:"mt-2"},z={class:"mt-5 w-full grid gap-6"},T={class:"flex flex-col gap-1"},M=h({__name:"ForgotPasswordView",setup(j){const m=F(),t=i(),n=i(!1),o=i(null),v=async()=>{o.value=null;const e=f.object({email:f.string({message:"Email is required"}).email({message:"Invalid email provided"})}).safeParse({email:t.value});if(!e.success){o.value=new p({message:e.error.errors[0].message,status:400,name:"ValidationError"});return}await S(`auth/check-user?field=email&value=${t.value}`,{loading:n,error:o,config:{router:m,withCredentials:!1}},l=>{if(!l.userExists){o.value=new p({message:"Your account does not exist or may have been deleted.",status:400,name:"NotFound"});return}m.push({name:"password-recovery",query:{userId:l.userId,email:btoa(t.value??""),emailSubject:"Invest Tracker Password Reset"}})})};return(g,e)=>{const l=V,_=C("RouterLink"),x=E,b=N,w=B;return u(),d("div",L,[a(l,{size:"24"}),s("header",P,[e[4]||(e[4]=s("h1",{class:"text-3xl md:text-4xl font-semibold"},"Forgot Password",-1)),s("p",R,[e[2]||(e[2]=r(" Go back to ")),a(_,{to:{name:"login"},class:"text-primary-500 font-semibold hover:underline"},{default:c(()=>e[1]||(e[1]=[r(" Log in ")])),_:1}),e[3]||(e[3]=r(". "))])]),o.value?(u(),d("div",$,[a(x,{size:"small",severity:"error",closable:""},{default:c(()=>[r(I(o.value.message),1)]),_:1})])):y("",!0),s("div",z,[s("div",T,[e[5]||(e[5]=s("label",{for:"email",class:"text-mute text-sm"},"Enter your email address",-1)),a(b,{id:"email",modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=k=>t.value=k),type:"email",fluid:""},null,8,["modelValue"])]),s("div",null,[a(w,{onClick:v,loading:n.value,disabled:n.value||!t.value,label:"Submit",fluid:""},null,8,["loading","disabled"])])])])}}});export{M as default};
