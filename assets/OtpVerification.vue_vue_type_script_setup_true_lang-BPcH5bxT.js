import{z as O,s as U}from"./index-Cw1MDNmN.js";import{P as R,Q as B,R as A,r as L,o,q as v,n as q,c as f,S as X,h as c,f as W,N as H,E as Z,J as G,b as h,t as M,j as E,H as d,F as J,i as Q,a as k,v as Y,A as ee,s as te}from"./index-rkqDWn-K.js";import{s as se}from"./index-DMxJWgcx.js";import{s as ie}from"./index-BZ2gPtDN.js";import{_ as ne}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-BkdBNGI_.js";import{m as ae}from"./helpers-BF5XYaOm.js";import{z as N}from"./index-ans_9-if.js";import{u as re}from"./index-BJLvgVPt.js";var le={root:function(e){var s=e.instance;return["p-inputmask",{"p-filled":s.$filled}]}},oe=R.extend({name:"inputmask",classes:le}),ue={name:"BaseInputMask",extends:ie,props:{slotChar:{type:String,default:"_"},id:{type:String,default:null},class:{type:[String,Object],default:null},mask:{type:String,default:null},placeholder:{type:String,default:null},autoClear:{type:Boolean,default:!0},unmask:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},style:oe,provide:function(){return{$pcInputMask:this,$parentInstance:this}}},z={name:"InputMask",extends:ue,inheritAttrs:!1,emits:["focus","blur","keydown","complete","keypress","paste"],inject:{$pcFluid:{default:null}},data:function(){return{currentVal:""}},watch:{mask:function(e,s){s!==e&&this.initMask()}},mounted:function(){this.initMask()},updated:function(){this.isValueUpdated()&&this.updateValue()},methods:{onInput:function(e){e.isComposing||(this.androidChrome?this.handleAndroidInput(e):this.handleInputChange(e),this.updateModelValue(e.target.value))},onFocus:function(e){var s=this;if(!this.readonly){this.focus=!0,clearTimeout(this.caretTimeoutId);var t;this.focusText=this.$el.value,t=this.checkVal(),this.caretTimeoutId=setTimeout(function(){s.$el===document.activeElement&&(s.writeBuffer(),t===s.mask.replace("?","").length?s.caret(0,t):s.caret(t))},10),this.$emit("focus",e)}},onBlur:function(e){var s,t;if(this.focus=!1,this.checkVal(),this.updateModelValue(e.target.value),this.$el.value!==this.focusText){var i=document.createEvent("HTMLEvents");i.initEvent("change",!0,!1),this.$el.dispatchEvent(i)}this.$emit("blur",e),(s=(t=this.formField).onBlur)===null||s===void 0||s.call(t,e)},onKeyDown:function(e){if(!this.readonly){var s=e.code,t,i,a,r=/iphone/i.test(B());this.oldVal=this.$el.value,s==="Backspace"||s==="Delete"||r&&s==="Escape"?(t=this.caret(),i=t.begin,a=t.end,a-i===0&&(i=s!=="Delete"?this.seekPrev(i):a=this.seekNext(i-1),a=s==="Delete"?this.seekNext(a):a),this.clearBuffer(i,a),this.shiftL(i,a-1),this.updateModelValue(e.target.value),e.preventDefault()):s==="Enter"?(this.$el.blur(),this.updateModelValue(e.target.value)):s==="Escape"&&(this.$el.value=this.focusText,this.caret(0,this.checkVal()),this.updateModelValue(e.target.value),e.preventDefault()),this.$emit("keydown",e)}},onKeyPress:function(e){var s=this;if(!this.readonly){var t=e.code,i=this.caret(),a,r,m,p;if(!(e.ctrlKey||e.altKey||e.metaKey||e.shiftKey||e.key==="CapsLock"||e.key==="Escape"||e.key==="Tab")){if(t&&t!=="Enter"){if(i.end-i.begin!==0&&(this.clearBuffer(i.begin,i.end),this.shiftL(i.begin,i.end-1)),a=this.seekNext(i.begin-1),a<this.len&&(r=e.key,this.tests[a].test(r))){if(this.shiftR(a),this.buffer[a]=r,this.writeBuffer(),m=this.seekNext(a),/android/i.test(B())){var g=function(){s.caret(m)};setTimeout(g,0)}else this.caret(m);i.begin<=this.lastRequiredNonMaskPos&&(p=this.isCompleted())}e.preventDefault()}this.updateModelValue(e.target.value),p&&this.$emit("complete",e),this.$emit("keypress",e)}}},onPaste:function(e){this.handleInputChange(e),this.$emit("paste",e)},caret:function(e,s){var t,i,a;if(!(!this.$el.offsetParent||this.$el!==document.activeElement))if(typeof e=="number")i=e,a=typeof s=="number"?s:i,this.$el.setSelectionRange?this.$el.setSelectionRange(i,a):this.$el.createTextRange&&(t=this.$el.createTextRange(),t.collapse(!0),t.moveEnd("character",a),t.moveStart("character",i),t.select());else return this.$el.setSelectionRange?(i=this.$el.selectionStart,a=this.$el.selectionEnd):document.selection&&document.selection.createRange&&(t=document.selection.createRange(),i=0-t.duplicate().moveStart("character",-1e5),a=i+t.text.length),{begin:i,end:a}},isCompleted:function(){for(var e=this.firstNonMaskPos;e<=this.lastRequiredNonMaskPos;e++)if(this.tests[e]&&this.buffer[e]===this.getPlaceholder(e))return!1;return!0},getPlaceholder:function(e){return e<this.slotChar.length?this.slotChar.charAt(e):this.slotChar.charAt(0)},seekNext:function(e){for(;++e<this.len&&!this.tests[e];);return e},seekPrev:function(e){for(;--e>=0&&!this.tests[e];);return e},shiftL:function(e,s){var t,i;if(!(e<0)){for(t=e,i=this.seekNext(s);t<this.len;t++)if(this.tests[t]){if(i<this.len&&this.tests[t].test(this.buffer[i]))this.buffer[t]=this.buffer[i],this.buffer[i]=this.getPlaceholder(i);else break;i=this.seekNext(i)}this.writeBuffer(),this.caret(Math.max(this.firstNonMaskPos,e))}},shiftR:function(e){var s,t,i,a;for(s=e,t=this.getPlaceholder(e);s<this.len;s++)if(this.tests[s])if(i=this.seekNext(s),a=this.buffer[s],this.buffer[s]=t,i<this.len&&this.tests[i].test(a))t=a;else break},handleAndroidInput:function(e){var s=this.$el.value,t=this.caret();if(this.oldVal&&this.oldVal.length&&this.oldVal.length>s.length){for(this.checkVal(!0);t.begin>0&&!this.tests[t.begin-1];)t.begin--;if(t.begin===0)for(;t.begin<this.firstNonMaskPos&&!this.tests[t.begin];)t.begin++;this.caret(t.begin,t.begin)}else{for(this.checkVal(!0);t.begin<this.len&&!this.tests[t.begin];)t.begin++;this.caret(t.begin,t.begin)}this.isCompleted()&&this.$emit("complete",e)},clearBuffer:function(e,s){var t;for(t=e;t<s&&t<this.len;t++)this.tests[t]&&(this.buffer[t]=this.getPlaceholder(t))},writeBuffer:function(){this.$el.value=this.buffer.join("")},checkVal:function(e){this.isValueChecked=!0;var s=this.$el.value,t=-1,i,a,r;for(i=0,r=0;i<this.len;i++)if(this.tests[i]){for(this.buffer[i]=this.getPlaceholder(i);r++<s.length;)if(a=s.charAt(r-1),this.tests[i].test(a)){this.buffer[i]=a,t=i;break}if(r>s.length){this.clearBuffer(i+1,this.len);break}}else this.buffer[i]===s.charAt(r)&&r++,i<this.partialPosition&&(t=i);return e?this.writeBuffer():t+1<this.partialPosition?this.autoClear||this.buffer.join("")===this.defaultBuffer?(this.$el.value&&(this.$el.value=""),this.clearBuffer(0,this.len)):this.writeBuffer():(this.writeBuffer(),this.$el.value=this.$el.value.substring(0,t+1)),this.partialPosition?i:this.firstNonMaskPos},handleInputChange:function(e){var s=e.type==="paste";if(!(this.readonly||s)){var t=this.checkVal(!0);this.caret(t),this.updateModelValue(e.target.value),this.isCompleted()&&this.$emit("complete",e)}},getUnmaskedValue:function(){for(var e=[],s=0;s<this.buffer.length;s++){var t=this.buffer[s];this.tests[s]&&t!==this.getPlaceholder(s)&&e.push(t)}return e.join("")},updateModelValue:function(e){if(this.currentVal!==e){var s=this.unmask?this.getUnmaskedValue():e;this.currentVal=e,this.writeValue(this.defaultBuffer!==s?s:"")}},updateValue:function(){var e=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.$el&&(this.d_value==null?(this.$el.value="",s&&this.updateModelValue("")):(this.$el.value=this.d_value,this.checkVal(),setTimeout(function(){e.$el&&(e.writeBuffer(),e.checkVal(),s&&e.updateModelValue(e.$el.value))},10)),this.focusText=this.$el.value)},initMask:function(){this.tests=[],this.partialPosition=this.mask.length,this.len=this.mask.length,this.firstNonMaskPos=null,this.defs={9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"};var e=B();this.androidChrome=/chrome/i.test(e)&&/android/i.test(e);for(var s=this.mask.split(""),t=0;t<s.length;t++){var i=s[t];i==="?"?(this.len--,this.partialPosition=t):this.defs[i]?(this.tests.push(new RegExp(this.defs[i])),this.firstNonMaskPos===null&&(this.firstNonMaskPos=this.tests.length-1),t<this.partialPosition&&(this.lastRequiredNonMaskPos=this.tests.length-1)):this.tests.push(null)}this.buffer=[];for(var a=0;a<s.length;a++){var r=s[a];r!=="?"&&(this.defs[r]?this.buffer.push(this.getPlaceholder(a)):this.buffer.push(r))}this.defaultBuffer=this.buffer.join(""),this.updateValue(!1)},isValueUpdated:function(){return this.unmask?this.d_value!=this.getUnmaskedValue():this.defaultBuffer!==this.$el.value&&this.$el.value!==this.d_value}},computed:{inputClass:function(){return[this.cx("root"),this.class]},rootPTOptions:function(){return{root:A(this.ptm("pcInputText",this.ptmParams),this.ptmi("root",this.ptmParams))}},ptmParams:function(){return{context:{filled:this.$filled}}}},components:{InputText:se}};function he(n,e,s,t,i,a){var r=L("InputText");return o(),v(r,{id:n.id,value:i.currentVal,class:q(a.inputClass),readonly:n.readonly,disabled:n.disabled,invalid:n.invalid,size:n.size,name:n.name,variant:n.variant,placeholder:n.placeholder,fluid:n.$fluid,unstyled:n.unstyled,onInput:a.onInput,onCompositionend:a.onInput,onFocus:a.onFocus,onBlur:a.onBlur,onKeydown:a.onKeyDown,onKeypress:a.onKeyPress,onPaste:a.onPaste,pt:a.rootPTOptions},null,8,["id","value","class","readonly","disabled","invalid","size","name","variant","placeholder","fluid","unstyled","onInput","onCompositionend","onFocus","onBlur","onKeydown","onKeypress","onPaste","pt"])}z.render=he;var de=function(e){var s=e.dt;return`
.p-skeleton {
    overflow: hidden;
    background: `.concat(s("skeleton.background"),`;
    border-radius: `).concat(s("skeleton.border.radius"),`;
}

.p-skeleton::after {
    content: "";
    animation: p-skeleton-animation 1.2s infinite;
    height: 100%;
    left: 0;
    position: absolute;
    right: 0;
    top: 0;
    transform: translateX(-100%);
    z-index: 1;
    background: linear-gradient(90deg, rgba(255, 255, 255, 0), `).concat(s("skeleton.animation.background"),`, rgba(255, 255, 255, 0));
}

[dir='rtl'] .p-skeleton::after {
    animation-name: p-skeleton-animation-rtl;
}

.p-skeleton-circle {
    border-radius: 50%;
}

.p-skeleton-animation-none::after {
    animation: none;
}

@keyframes p-skeleton-animation {
    from {
        transform: translateX(-100%);
    }
    to {
        transform: translateX(100%);
    }
}

@keyframes p-skeleton-animation-rtl {
    from {
        transform: translateX(100%);
    }
    to {
        transform: translateX(-100%);
    }
}
`)},fe={root:{position:"relative"}},ce={root:function(e){var s=e.props;return["p-skeleton p-component",{"p-skeleton-circle":s.shape==="circle","p-skeleton-animation-none":s.animation==="none"}]}},pe=R.extend({name:"skeleton",theme:de,classes:ce,inlineStyles:fe}),me={name:"BaseSkeleton",extends:X,props:{shape:{type:String,default:"rectangle"},size:{type:String,default:null},width:{type:String,default:"100%"},height:{type:String,default:"1rem"},borderRadius:{type:String,default:null},animation:{type:String,default:"wave"}},style:pe,provide:function(){return{$pcSkeleton:this,$parentInstance:this}}},K={name:"Skeleton",extends:me,inheritAttrs:!1,computed:{containerStyle:function(){return this.size?{width:this.size,height:this.size,borderRadius:this.borderRadius}:{width:this.width,height:this.height,borderRadius:this.borderRadius}}}};function ge(n,e,s,t,i,a){return o(),f("div",A({class:n.cx("root"),style:[n.sx("root"),a.containerStyle],"aria-hidden":"true"},n.ptmi("root")),null,16)}K.render=ge;const ke=c(O(N.object({otp:N.string({message:"OTP is required"}).length(6,{message:"The OTP must contain 6 digits."})}))),ve={class:"text-3xl md:text-4xl font-semibold"},be={key:0},ye={class:"font-semibold"},$e={class:"mt-5 w-full grid gap-3"},Pe={key:0,class:"grid gap-3"},Ve={class:"grid grid-cols-6 gap-2"},Be={class:"flex flex-col gap-1"},Me={key:0,class:"font-medium text-red-500"},Se={key:4,class:"mt-3"},S=30,Te=10,we=120,Ke=W({__name:"OtpVerification",props:{pageTitle:{},email:{},userId:{},token:{},loading:{type:Boolean},error:{},emailSubject:{}},emits:["submit"],setup(n,{emit:e}){const s=ee(),t=e,i=c(),a=c(0),r=l=>{i.value&&clearInterval(i.value),a.value=l,i.value=setInterval(()=>{if(a.value===0){clearInterval(i.value);return}a.value-=1},1e3)},m=()=>{clearInterval(i.value),a.value=0},p=c(!1),g=c(null),y=c(null),$=c(0),P=async()=>{y.value=await re(`auth/email-verification-token?userId=${n.userId}&emailSubject=${n.emailSubject}`,{loading:p,error:g,config:{method:"POST",withCredentials:!1,router:s,body:{email:n.email}}},()=>{$.value++;const l=$.value>1?Math.min(S+($.value-1)*Te,we):S;r(l)})},_=H({otp:void 0}),j=({valid:l,values:u})=>{l&&t("submit",u.otp)};return Z(async()=>{if(n.token){t("submit",n.token);return}n.email&&(await P(),r(S))}),G(()=>{m()}),(l,u)=>{const T=K,w=ne,D=z,V=te,F=U;return o(),f("div",null,[h("header",null,[h("h1",ve,M(l.pageTitle),1),l.email?(o(),f("div",be,[u[0]||(u[0]=h("p",{class:"text-mute"},"Enter the OTP that has been sent to your email address.",-1)),h("p",ye,M(E(ae)(l.email)),1),u[1]||(u[1]=h("p",{class:"mt-1 text-xs text-primary-500 font-semibold"}," Don't forget to check your spam folder too. ",-1))])):d("",!0)]),h("div",$e,[p.value?(o(),f("div",Pe,[h("div",Ve,[(o(),f(J,null,Q(6,b=>k(T,{key:b,width:"100%",height:"3rem","border-radius":"0.5rem"})),64))]),k(T,{width:"100%",height:"3rem","border-radius":"0.5rem"})])):g.value?(o(),v(w,{key:1,onRetry:P,request:"GET",error:g.value},null,8,["error"])):d("",!0),l.error?(o(),v(w,{key:2,error:l.error},null,8,["error"])):d("",!0),y.value?(o(),v(F,{key:3,initialValues:_,resolver:E(ke),validateOnValueUpdate:!0,validateOnBlur:!0,onSubmit:j,class:"flex flex-col gap-4 w-full"},{default:Y(b=>{var I,x,C;return[h("div",Be,[u[2]||(u[2]=h("label",{class:"text-mute text-sm"},"Enter your OTP",-1)),k(D,{name:"otp",mask:"999999",placeholder:"999999",fluid:""}),(I=b.otp)!=null&&I.invalid?(o(),f("small",Me,M((C=(x=b.otp)==null?void 0:x.error)==null?void 0:C.message),1)):d("",!0)]),k(V,{type:"submit",label:"Submit",loading:l.loading},null,8,["loading"])]}),_:1},8,["initialValues","resolver"])):d("",!0),p.value?d("",!0):(o(),f("div",Se,[u[3]||(u[3]=h("span",null,"Didn't get the email? ",-1)),k(V,{onClick:P,disabled:a.value>0,label:`Resend ${a.value>0?`in ${a.value}s`:""}`,text:""},null,8,["disabled","label"])])),l.token&&l.loading?(o(),v(V,{key:5,loading:l.loading,label:"Verifying your email. Please wait..."},null,8,["loading"])):d("",!0)])])}}});export{Ke as _};
