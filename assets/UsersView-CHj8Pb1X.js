import{_ as I}from"./VPaginator.vue_vue_type_script_setup_true_lang-BNbyFI4K.js";import{s as M,a as R}from"./index-B17cVOnJ.js";import{f as T,h as r,D as A,C as G,E as S,o as l,c as d,a as e,v as i,b as t,q as k,H as V,A as F,t as p,k as H,j as K,s as J,K as O}from"./index-BeBYLbm4.js";import{_ as Q}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-CC07B55Y.js";import{_ as W}from"./PageLoader-ASoPjOmp.js";import{_ as X}from"./VCard.vue_vue_type_script_setup_true_lang-BSr0I-Iy.js";import{_ as Y}from"./UserManager.vue_vue_type_script_setup_true_lang-B99OUA9E.js";import{u as U}from"./index-CODlRzTV.js";import"./index-KYbbszim.js";import"./index-BJYIcNqT.js";import"./index-Dnf1wTNt.js";import"./index-Ca6bNHhN.js";import"./index-CcuxF0nQ.js";import"./index-CROb7Z2g.js";import"./index-nFlc9OXx.js";import"./index-Bgf8OROJ.js";import"./VFileUploader.vue_vue_type_script_setup_true_lang-CNL7LxJy.js";import"./country-by-name-Di7sd6fA.js";import"./index-ans_9-if.js";const Z={class:"flex items-center gap-2 justify-between"},ee={class:"flex items-center gap-2 text-lg font-semibold text-primary-500"},se={key:0,class:"pi pi-spinner animate-spin"},oe={key:1},te={key:2},ne={class:"mt-2"},ae={key:2,class:"w-full md:h-[calc(100dvh-9rem)] overflow-y-auto"},le={class:"w-full overflow-x-auto"},re={key:0,class:"w-8 aspect-square overflow-hidden rounded-full"},ie=["src","alt"],ue={class:"flex items-center gap-2"},_=10,Be=T({__name:"UsersView",setup(ce){const f=F(),a=r(null),v=r(!1),g=r(null),w=r(!1),m=r(0),b=A(()=>m.value*_),y=async()=>{await U(`admin/users?skip=${b.value}&limit=${_}&where=role,user`,{loading:v,error:g,config:{router:f,cache:!0}},n=>{a.value=n.data,w.value=n.data.length<_})};G(m,y);const z=n=>{!a.value||n.role!=="user"||(a.value=[n,...a.value])},D=n=>{if(!a.value)return;const o=a.value.findIndex(c=>c.id===n.id);o<0||(n.role==="user"?a.value.splice(o,1,n):a.value.splice(o,1))},h=r(!1),C=r(null),x=r(),$=async()=>{await U("admin/count/users?where=role,user",{loading:h,error:C,config:{router:f,cache:!0}},n=>{x.value=n.count})};return S(async()=>{await Promise.all([$(),y()])}),(n,o)=>{const c=J,N=Y,B=X,E=W,L=Q,u=R,P=O,j=M,q=I;return l(),d("div",null,[e(B,{class:"py-2 rounded-xl"},{default:i(()=>[t("div",Z,[t("div",ee,[o[3]||(o[3]=t("h1",null,"Users",-1)),t("div",null,[h.value?(l(),d("span",se)):C.value?(l(),d("div",oe,[o[2]||(o[2]=t("small",{class:"block text-xs text-red-500 font-medium"},"Failed to get number of users",-1)),e(c,{onClick:$,label:"Retry",icon:"pi pi-replay",loading:h.value,size:"small",severity:"danger",class:"py-0"},null,8,["loading"])])):x.value?(l(),d("p",te,"("+p(x.value)+")",1)):V("",!0)])]),t("div",null,[e(N,{onDone:z},{default:i(()=>[e(c,{label:"New",icon:"pi pi-plus",size:"small"})]),_:1})])])]),_:1}),t("div",ne,[v.value?(l(),k(E,{key:0})):g.value?(l(),k(L,{key:1,error:g.value,request:"GET",onRetry:y},null,8,["error"])):a.value?(l(),d("div",ae,[t("div",le,[e(j,{loading:v.value,value:a.value,size:"small",class:"text-sm"},{default:i(()=>[e(u,{header:"S/N"},{body:i(({index:s})=>[H(p(s+1+b.value)+") ",1)]),_:1}),e(u,null,{body:i(({data:s})=>[s.image?(l(),d("div",re,[t("img",{src:s.image,alt:s.name,class:"w-full h-full object-cover"},null,8,ie)])):(l(),k(P,{key:1,name:"account_circle",size:"2rem",class:"text-primary-500"}))]),_:1}),e(u,{field:"name",header:"Name"}),e(u,{field:"email",header:"Email"}),e(u,{field:"phoneNumber",header:"Phone"}),e(u,{header:"Location"},{body:i(({data:s})=>[t("p",null,[t("span",null,p(s.region),1),o[4]||(o[4]=t("span",null,", ",-1)),t("span",null,p(s.country),1)])]),_:1}),e(u,null,{body:i(({data:s})=>[t("div",ue,[e(c,{onClick:de=>K(f).push({name:"admin-user",params:{userId:s.id}}),size:"small",icon:"pi pi-user",rounded:""},null,8,["onClick"]),e(N,{user:s,onDone:D},{default:i(()=>[e(c,{size:"small",icon:"pi pi-user-edit",rounded:"",severity:"secondary"})]),_:2},1032,["user"])])]),_:1})]),_:1},8,["loading","value"]),e(q,{allLoaded:w.value,rows:_,onPrev:o[0]||(o[0]=s=>m.value=s),onNext:o[1]||(o[1]=s=>m.value=s)},null,8,["allLoaded"])])])):V("",!0)])])}}});export{Be as default};
