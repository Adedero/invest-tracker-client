import{_ as G}from"./VPaginator.vue_vue_type_script_setup_true_lang-C5m9_AT5.js";import{s as H,a as F}from"./index-C0IBe5FA.js";import{f as K,h as i,D as z,g as J,C as O,E as Q,o as a,c as u,a as o,v as r,b as n,q as b,H as f,A as W,t as m,j as A,bp as X,k as B,s as Y,K as Z}from"./index-CW21LfwU.js";import{_ as ee}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-BjwNYmRP.js";import{_ as se}from"./PageLoader-CZ-Kt3Ck.js";import{_ as oe}from"./VCard.vue_vue_type_script_setup_true_lang-BEXAQp5x.js";import{_ as te}from"./UserManager.vue_vue_type_script_setup_true_lang-BZZstHWK.js";import{s as ne}from"./index-BVElFObk.js";import{u as D}from"./index-Bco5Uctx.js";import"./index-By7NwKG_.js";import"./index-D1yCMm1e.js";import"./index-Bl-tvBni.js";import"./index-C-BpVv3R.js";import"./index-DIdFwiiu.js";import"./index-CfSZgD9B.js";import"./index-LwYLjdfv.js";import"./VFileUploader.vue_vue_type_script_setup_true_lang-C6UUfPzy.js";import"./country-by-name-Di7sd6fA.js";import"./index-ans_9-if.js";const le={class:"flex items-center gap-2 justify-between"},ae={class:"flex items-center gap-2 text-lg font-semibold text-primary-500"},re={key:0,class:"pi pi-spinner animate-spin"},ie={key:1},ue={key:2},ce={class:"flex flex-wrap items-center justify-end gap-1"},de={class:"mt-2"},me={key:2,class:"w-full md:h-[calc(100dvh-9rem)] overflow-y-auto"},pe={class:"w-full overflow-x-auto"},_e={key:0,class:"w-8 aspect-square overflow-hidden rounded-full"},fe=["src","alt"],ve={key:0,class:"text-red-500 font-medium text-xs"},ge={key:0,class:"flex items-center gap-2"},v=10,Te=K({__name:"UsersView",setup(ye){const g=W(),l=i(null),y=i(!1),h=i(null),C=i(!1),p=i(0),V=z(()=>p.value*v),x=async()=>{await D(`admin/users?skip=${V.value}&limit=${v}`,{loading:y,error:h,config:{router:g,cache:!0}},t=>{l.value=t.data,C.value=t.data.length<v})},_=J("showAdmins",!1),$=z(()=>{var t;return _.value?l.value:(t=l==null?void 0:l.value)==null?void 0:t.filter(s=>s.role==="user")});O(p,x);const E=t=>{!l.value||t.role!=="user"||(l.value=[t,...l.value])},P=t=>{if(!l.value)return;const s=l.value.findIndex(d=>d.id===t.id);s<0||(t.role==="user"?l.value.splice(s,1,t):l.value.splice(s,1))},w=i(!1),N=i(null),k=i(),U=async()=>{await D("admin/count/users?where=role,user",{loading:w,error:N,config:{router:g,cache:!0}},t=>{k.value=t.count})};return Q(async()=>{await Promise.all([U(),x()])}),(t,s)=>{const d=Y,j=ne,L=te,R=oe,S=se,T=ee,c=F,q=Z,I=H,M=G;return a(),u("div",null,[o(R,{class:"py-2 rounded-xl"},{default:r(()=>[n("div",le,[n("div",ae,[s[4]||(s[4]=n("h1",null,"Users",-1)),n("div",null,[w.value?(a(),u("span",re)):N.value?(a(),u("div",ie,[s[3]||(s[3]=n("small",{class:"block text-xs text-red-500 font-medium"},"Failed to get number of users",-1)),o(d,{onClick:U,label:"Retry",icon:"pi pi-replay",loading:w.value,size:"small",severity:"danger",class:"py-0"},null,8,["loading"])])):k.value?(a(),u("p",ue,"("+m(k.value)+")",1)):f("",!0)])]),n("div",ce,[n("div",null,[o(j,{modelValue:A(_),"onUpdate:modelValue":s[0]||(s[0]=e=>X(_)?_.value=e:null),onLabel:"Hide Admins",offLabel:"Show Admins",class:"text-sm"},null,8,["modelValue"])]),o(L,{onDone:E},{default:r(()=>[o(d,{label:"New",icon:"pi pi-plus",size:"small"})]),_:1})])])]),_:1}),n("div",de,[y.value?(a(),b(S,{key:0})):h.value?(a(),b(T,{key:1,error:h.value,request:"GET",onRetry:x},null,8,["error"])):$.value?(a(),u("div",me,[n("div",pe,[o(I,{loading:y.value,value:$.value,size:"small",class:"text-sm"},{default:r(()=>[o(c,{header:"S/N"},{body:r(({index:e})=>[B(m(e+1+V.value)+") ",1)]),_:1}),o(c,null,{body:r(({data:e})=>[e.image?(a(),u("div",_e,[n("img",{src:e.image,alt:e.name,class:"w-full h-full object-cover"},null,8,fe)])):(a(),b(q,{key:1,name:"account_circle",size:"2rem",class:"text-primary-500"}))]),_:1}),o(c,{field:"name",header:"Name"},{body:r(({data:e})=>[B(m(e.name)+" ",1),e.role==="admin"?(a(),u("sup",ve,"admin")):f("",!0)]),_:1}),o(c,{field:"email",header:"Email"}),o(c,{field:"phoneNumber",header:"Phone"}),o(c,{header:"Location"},{body:r(({data:e})=>[n("p",null,[n("span",null,m(e.region),1),s[5]||(s[5]=n("span",null,", ",-1)),n("span",null,m(e.country),1)])]),_:1}),o(c,null,{body:r(({data:e})=>[e.role!=="admin"?(a(),u("div",ge,[o(d,{onClick:he=>A(g).push({name:"admin-user",params:{userId:e.id}}),size:"small",icon:"pi pi-user",rounded:""},null,8,["onClick"]),o(L,{user:e,onDone:P},{default:r(()=>[o(d,{size:"small",icon:"pi pi-user-edit",rounded:"",severity:"secondary"})]),_:2},1032,["user"])])):f("",!0)]),_:1})]),_:1},8,["loading","value"]),o(M,{allLoaded:C.value,rows:v,onPrev:s[1]||(s[1]=e=>p.value=e),onNext:s[2]||(s[2]=e=>p.value=e)},null,8,["allLoaded"])])])):f("",!0)])])}}});export{Te as default};
